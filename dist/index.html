<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Search USAF regulations (unofficial)</title><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="author" content="//that.pub/humans.txt"><link rel="shortcut icon" href="//that.pub/img/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="//that.pub/img/apple-touch-icon.png"><script type="text/javascript">var rootElement = document.documentElement||document.body.parentNode;
      WebFontConfig={google:{families:["Lato:400,700:latin"]}};(function(){var a=document.createElement("script");a.src=("https:"==document.location.protocol?"https":"http")+"://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js";a.type="text/javascript";a.async="true";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)})();</script><style>#related-list,ul{list-style:none}#query,#send,a,a:active,a:hover{outline:0}.clearfix:after,.text{clear:both}#related .doc,#summary,.text{text-rendering:optimizeLegibility}a,b,body,details,div,form,h2,header,i,iframe,img,label,li,object,output,p,q,s,section,small,span,strong,sub,summary,sup,time,u,ul,var,video{margin:0;padding:0;border:0;font:inherit;vertical-align:baseline}details,header,section,summary{display:block}blockquote:after,blockquote:before,q:after,q:before{content:'';content:none}template{display:none}a{background-color:transparent}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}small{font-size:75%}img{border:0}svg:not(:root){overflow:hidden}button,input,select,textarea{font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}.ir:before{content:"";display:block;width:0;height:150%}.hidden{display:none!important;visibility:hidden}.visuallyhidden.focusable:active,.visuallyhidden.focusable:focus{clip:auto;height:auto;margin:0;overflow:visible;position:static;width:auto}.clearfix:after,.clearfix:before{content:" ";display:table}#infini-check,#search-restore{width:3.2rem;height:3.2rem;position:fixed;display:block;top:1rem}#search-restore{z-index:3;right:1rem}#search-restore svg{-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;background-color:#FEFEFE;fill:#FF9000!important;stroke:#FF9000!important}#search-restore #ico{padding:.5rem;border:2px solid #FF9000}#search-restore #x{padding:.2rem;border:2px solid transparent}#search-restore:hover svg{border-color:#FEFEFE}#search-restore:hover svg#ico,#search-restore:hover svg#x{background-color:#FF9000;fill:#FEFEFE!important;stroke:#FEFEFE!important}#infini-check{left:1rem}#infini-check input{display:none}#infini-label{display:block;cursor:pointer;z-index:3;width:3.2rem;height:3.2rem}#loader,#loader .spinner{display:none}#infini-label svg{position:absolute;left:0;top:0}#page,#wrap,q{position:relative}#infini-label svg path{fill:#FF9000}#infini-label svg rect{fill:#FEFEFE!important;stroke:#FF9000!important}#infini-label:hover svg path{fill:#FEFEFE}#infini-label:hover svg rect{fill:#888!important;stroke:#FEFEFE!important}#infini-label.disabled svg path{fill:#888}#infini-label.disabled svg rect{fill:#FEFEFE!important;stroke:#888!important}#infini-label.disabled:hover svg path{fill:#FEFEFE}#infini-label.disabled:hover svg rect{fill:#FF9000!important;stroke:#FEFEFE!important}*,:after,:before{-webkit-box-sizing:border-box!important;-moz-box-sizing:border-box!important;box-sizing:border-box!important}html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;overflow-y:scroll;-webkit-font-smoothing:subpixel-antialiased;-moz-osx-font-smoothing:greyscale;zoom:1;font-size:100%}body,html{min-height:100%;min-width:100%}::-moz-selection{background:#AAA;color:#FEFEFE;text-shadow:none}::selection{background:#AAA;color:#FEFEFE;text-shadow:none}body,button,html,input,select,textarea{color:#666;outline:0;font-weight:400}body{margin:0;font-family:HelveticaNeue-Light,"Helvetica Neue Light","Helvetica Neue",Helvetica,Tahoma,Arial,sans-serif;font-size:15px;line-height:1.4;background:#F5F5F5}#search,#search-title{text-align:left;font-family:Lato,"Open Sans",Roboto,"Helvetica Neue",sans-serif}a{color:#0074B2;text-decoration:none;border-bottom:1px solid transparent}.clickable{-ms-touch-action:manipulation;touch-action:manipulation}q{quotes:"“" "”" "‘" "’"}q:before{content:open-quote}q:after{content:close-quote}#wrap{width:100%;margin:auto}#page{box-shadow:0 0 3px rgba(0,0,0,.25);-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;background-color:#FEFEFE;top:0;padding:2rem 2rem 8rem;border-right:1px solid #F5F5F5;border-left:1px solid #F5F5F5;width:80%;margin:0 auto 3rem}#page:after,#page:before{position:absolute;z-index:-1;bottom:26px;box-shadow:0 28px 8px rgba(0,0,0,.25);content:"";height:28px;width:48%}#page:before{left:2%;transform:rotate(-3deg)}#page:after{right:2%;transform:rotate(3deg)}#loader,#search-wrap{right:0;bottom:0;height:100%}#loader{opacity:0;position:fixed;z-index:-2;background:#FEFEFE;top:0;left:0;width:100%}.spinner,.spinner .blob{position:absolute;top:50%;left:50%}#loader.loading{-webkit-transition:opacity .05s ease-out;-moz-transition:opacity .05s ease-out;-o-transition:opacity .05s ease-out;transition:opacity .05s ease-out;display:block;z-index:4;opacity:1}#loader.loading .spinner{display:block}.spinner{transform:translate3d(-50%,-50%,0);width:2rem;height:2rem}.spinner,.spinner .blob{-ms-transform:translate3d(-50%,-50%,0);-webkit-transform:translate3d(-50%,-50%,0)}.spinner .blob{transform:translate3d(-50%,-50%,0);-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;border:2px solid #00A5FF;width:10px;height:10px}.spinner .blob.top{top:0;animation:blob-top 1s infinite ease-in}.spinner .blob.bottom{top:100%;animation:blob-bottom 1s infinite ease-in}.spinner .blob.left{left:0;animation:blob-left 1s infinite ease-in}.spinner .move-blob{background:#000;top:0;animation:blob-spinner-mover 1s infinite ease-in}#search-wrap{-ms-transform:translate3d(0,0,0);-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0);position:fixed;display:table;pointer-events:none;opacity:0;top:0;left:0;max-width:100%;margin:0;width:100%}#query,#search,#send{margin-left:auto;margin-right:auto}#search-wrap.emerge,#search-wrap.failed{width:100%;pointer-events:auto;z-index:3;opacity:1;height:100%}#query,#related-list,#results,#search,#search-title,#send,.content,.text,.text q:after,.text q:before{position:relative}#search-wrap.emerge{transform:translate3d(0,0,0)}#search-wrap.emerge,#search-wrap.failed{-ms-transform:translate3d(0,0,0);-webkit-transform:translate3d(0,0,0)}#search-wrap.failed{transform:translate3d(0,0,0);color:#6D29CC}#search{display:table-cell;vertical-align:middle;background-color:#FEFEFE;padding:2rem}#search-title{color:#FF9000;font-size:4rem;line-height:1;width:100%;padding:1rem 0}.meta,.text{line-height:1.7}#search-title small{margin-top:1rem;margin-bottom:1rem;color:#ffe9cc;font-size:1rem;text-align:right;float:right}#query,#send{clear:both}#query{border-radius:4px;background-color:transparent;text-align:left;float:left;max-width:100%;width:100%;border:1px solid #FF9000;color:#666;font-size:1.4rem;margin-top:3rem;margin-bottom:1.5rem;padding:.6rem}#related .doc,#send,#summary{text-align:center}#query,#send{-webkit-border-radius:4px;-moz-border-radius:4px}#query.invalidated{border-color:#976AD4;color:#6D29CC}#query.invalidated::-webkit-input-placeholder{display:inline;width:100%;white-space:normal;opacity:.5;font-size:inherit;color:#976AD4}#query.invalidated::-moz-input-placeholder{display:inline;width:100%;white-space:normal;opacity:.5;font-size:inherit;color:#976AD4}#query.invalidated:-ms-input-placeholder{display:inline;width:100%;white-space:normal;opacity:.5;font-size:inherit;color:#976AD4}#query::-webkit-input-placeholder{display:inline;width:100%;white-space:normal;opacity:.5;font-size:inherit;color:#FFB14C}#query::-moz-input-placeholder{display:inline;width:100%;white-space:normal;opacity:.5;font-size:inherit;color:#FFB14C}#query:-ms-input-placeholder{display:inline;width:100%;white-space:normal;opacity:.5;font-size:inherit;color:#FFB14C}#send{border-radius:4px;display:block;background-color:#FF9000;color:#FEFEFE;border:none;margin:.4rem 0 0;border-bottom:1px solid #cc7300;border-top:1px solid #ffd399;max-width:14rem;width:calc(50% - 2rem);font-weight:700;font-size:2rem;padding:1rem;float:right}#send:active{border-bottom-color:transparent;border-top-color:#f08700;background-color:#f08700;color:#f6f6f6}#page-header{background-color:#FF9000;border-bottom:2px solid #FEFEFE;color:#FEFEFE;padding-top:3rem;padding-bottom:3rem;font-size:1rem}#summary{font-weight:400;margin-left:4.5rem;margin-right:4.5rem;max-width:calc(100% - 9rem);width:100%}#term{font-size:2em}#count,#term,#total{text-shadow:0 1px 1px #888;color:#FEFEFE;font-weight:700}#related{padding-bottom:.6rem;padding-top:.6rem;font-size:1rem}#related-label{display:none}#related-list{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:center;width:90%;max-width:864px;margin:0 auto;border:none}#related .doc{-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;cursor:default;flex-shrink:1;background-color:#FEFEFE;color:#FFB14C;font-weight:700;font-size:1em;border:1px solid;margin:.4rem;padding:.2rem .4rem}#related .doc.pretty{color:#FF9000}.content{color:#AAA;font-size:1.2rem;padding-bottom:3rem;padding-top:3rem}.meta,.reveal-text{font-family:Lato,"Open Sans",Roboto,"Helvetica Neue",sans-serif;font-size:.8em}.content em{color:#00A5FF;font-style:normal!important;font-weight:700}.content.pretty .text{padding-left:2rem;border-left:3px solid}.content:nth-child(n){border-bottom:1px solid rgba(200,200,200,.25)}.content:last-child{border-bottom:none}.content:first-child{padding-top:0}.text{color:#666;overflow:hidden}.text q{padding-bottom:.2rem;padding-top:.2rem;padding-left:1rem;margin-bottom:.8rem;display:block;color:#888;border-left:4px solid #F5F5F5}.text .combined,.text .parts{transition:opacity .15s ease-out;margin-bottom:1rem;display:block}.text .combined,.text .parts,.text.opened .combined,.text.opened .parts{-webkit-transition:opacity .15s ease-out;-moz-transition:opacity .15s ease-out;-o-transition:opacity .15s ease-out}.text .combined{position:absolute;top:0;left:0;opacity:0;z-index:0}.text .parts,.text.opened .combined{position:relative;opacity:1;z-index:1}.text.opened .combined,.text.opened .parts{transition:opacity .15s ease-out}.text.opened .parts{position:absolute;opacity:0;top:0;left:0;z-index:0}.info,.meta,.reveal-text{position:relative}.reveal-text{display:inline-block;background-color:#00A5FF;color:#FEFEFE;border:1px solid;padding:.2rem .6rem;font-weight:700;margin:1rem 0}.opened .reveal-text{color:#00A5FF;background-color:#FEFEFE}.meta{color:#666;max-width:100%;width:100%;margin-top:1rem}.details,.info{overflow:hidden;max-width:50%;margin-left:0;margin-right:0}.content:hover .meta .info .pub,.content:hover .meta .info .title{color:#000}.details{text-align:left;float:left}.info{color:inherit;text-align:right;float:right}.info .pub,.info .title{border-bottom:1px solid transparent}.info:hover .pub,.info:hover .title{border-bottom-color:#000}#more-content{-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;display:block;background-color:#00A5FF;color:#FEFEFE;text-align:center;border:none;margin:.4rem auto 0;padding:1.25rem;border-bottom:1px solid #0084cc;border-top:1px solid #99dbff;position:absolute;font-family:Lato,"Open Sans",Roboto,"Helvetica Neue",sans-serif;font-size:2.5rem;bottom:2rem;max-width:90%;width:100%;left:5%;right:5%}#more-content:active{border-bottom-color:transparent;border-top-color:#009bf0;background-color:#009bf0;color:#f6f6f6}@media only screen and (min-width:1076px){#search-restore{right:calc((100% - 864px)/ 2 - 4.2rem)}#infini-check{left:calc((100% - 864px)/ 2 - 4.2rem)}}@keyframes blob-bottom{25%,50%,75%{top:50%;left:100%}100%{top:0;left:50%}}@keyframes blob-left{25%{top:50%;left:0}100%,50%{top:100%;left:50%}}@keyframes blob-top{50%{top:0;left:50%}100%,75%{top:50%;left:0}}@keyframes blob-spinner-mover{0%,100%{top:0;left:50%}25%{top:50%;left:100%}50%{top:100%;left:50%}75%{top:50%;left:0}}@media only screen and (min-width:480px){#page{width:85%}#search{padding-left:4rem;padding-right:4rem}}@media only screen and (min-width:640px){#page{width:90%;margin-bottom:4rem;max-width:864px}#search{padding-left:30%;padding-right:30%}#search-title{font-size:5rem;padding-left:1rem;padding-right:1rem}}@media only screen and (min-device-width:375px) and (max-device-width:667px) and (-webkit-min-device-pixel-ratio:2) and (orientation:landscape){#search-title{font-size:4.5rem;padding-top:0;padding-bottom:0}}@media screen and (device-width:320px) and (device-height:640px) and (-webkit-device-pixel-ratio:3){#page,#search-restore svg{border-left-top-radius:4px;border-right-top-radius:4px;border-right-bottom-radius:4px;border-left-bottom-radius:4px}.spinner .blob{border-left-top-radius:50%;border-right-top-radius:50%;border-right-bottom-radius:50%;border-left-bottom-radius:50%}#query{border-left-top-radius:4px;border-right-top-radius:4px;border-right-bottom-radius:4px;border-left-bottom-radius:4px}}@media only screen and (min-width:640px) and (device-width:320px) and (device-height:640px) and (-webkit-device-pixel-ratio:3){#query{border-left-top-radius:0;border-right-top-radius:0;border-right-bottom-radius:0;border-left-bottom-radius:0}}@media only screen and (min-width:640px){#query{-webkit-border-radius:0;-moz-border-radius:0;border-radius:0;border-left-color:transparent;border-right-color:transparent;border-top-color:transparent;font-size:2rem;padding:1rem}#send{margin-left:1rem;margin-right:1rem}}@media only screen and (min-width:480px){#page-header{font-size:1.2rem}}@media only screen and (min-width:640px){#page-header{font-size:1.4rem}}@media only screen and (min-width:960px){#page{width:100%}#page-header{font-size:1.8rem}#summary{margin-left:auto;margin-right:auto;max-width:864px;width:100%}}@media only screen and (min-width:480px){#related{padding-bottom:1rem;padding-top:1rem;font-size:1.2rem}}@media only screen and (min-width:640px){#related{padding-bottom:2rem;padding-top:2rem}#related .doc{padding:.3rem .45rem}}@media only screen and (min-width:960px){#related .doc{padding:.4rem .6rem}}@media only screen and (min-width:640px){.content:first-child{padding-top:2rem}.content{padding-left:3rem;padding-right:3rem}.text{font-size:1.4rem;margin-left:auto;margin-right:auto}}@media only screen and (min-width:960px){.text{font-size:1.6rem}}@media screen and (device-width:320px) and (device-height:640px) and (-webkit-device-pixel-ratio:3){#more-content,#related .doc,#send{border-left-top-radius:4px;border-right-top-radius:4px;border-right-bottom-radius:4px;border-left-bottom-radius:4px}}</style></head><body><!--[if lte IE 9]><p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p><![endif]--><div id="loader"><div class="spinner"><div class="blob top"></div><div class="blob bottom"></div><div class="blob left"></div><div class="blob move-blob"></div></div></div><div id="search-wrap" class="emerge"><div id="search"><header id="search-title">Find a rule<br/><small>then go break it.</small></header><input class="needsclick" id="query" type="search" name="query" placeholder="Ex: dawg msme sgp" autofocus tabindex="0" autocomplete="off" data-control="input"/><label class="needsclick" id="message" for="query"></label><noscript><p>Clicking this button is just gonna disappoint you.</p></noscript><a href="#page" class="clickable" id="send" role="button"><span class="action">go</span></a></div></div><a href="#" id="search-restore" class="clickable" data-control="button"><svg xmlns="//www.w3.org/2000/svg" enable-background="new 0 0 512 512" height="48" id="ico" version="1.2" viewBox="0 0 512 512" width="48" xml:space="preserve" style="display:none"><path d="M498 498c-19 19-49 19-68 0l-85-85c-35 22-76 36-121 36C100 449 0 348 0 224S100 0 224 0c124 0 224 100 224 224 0 45-13 86-36 121l85 85C517 449 517 479 498 498zM224 64c-89 0-160 72-160 160 0 89 72 160 160 160 89 0 160-72 160-160C385 136 313 64 224 64z"/></svg> <svg xmlns:svg="//www.w3.org/2000/svg" xmlns="//www.w3.org/2000/svg" version="1.1" viewBox="0 0 48 48" width="48" height="48" id="x" style="display:none"><g transform="translate(0,-1004)"><g transform="matrix(1,0,0,0.9991,0.0022,0.9927)"><rect width="44.64" height="21.56" x="731.8" y="693.8" transform="matrix(0.702,0.7121,-0.7173,0.6968,0,0)" class="s0"/><rect width="44.65" height="21.56" x="676.6" y="-759.5" transform="matrix(-0.7119,0.7022,-0.6966,-0.7175,0,0)" class="s0"/></g></g></svg></a><div id="wrap"><div id="page-header"><div id="summary"><p>showing <span id="count"></span> of <span id="total"></span> results for</p><q id="term"></q></div></div><div id="related"><h2 id="related-label" class="label">Related Documents</h2><ul id="related-list"></ul></div><div id="page"><div id="results"></div><a href="#" class="more content clickable" role="button" id="more-content"><span class="action">more, please</span></a></div></div><div id="infini-check"><label for="infini-scroll" class="enabled clickable" id="infini-label" title="Disable infinite scroll"><svg xmlns:svg="//www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" version="1.1" width="48" height="48" id="refresh"><g transform="translate(0,-1004)"><rect width="46.2" height="46.06" ry="1.894" x="0.959" y="1005" style="fill:none;stroke-linejoin:round;stroke-width:1.922;stroke:#000"/><path d="m27.17 1045c2.19-3 3.83-7 3.83-11 0-1-0.42-1-2.81-1-3.37 0-3.57-1-0.7-4 0 0 0 0 2.4-3 0 0 1.43-2 2.53-3 1.82-2 1.82-2 3.63 0 1.59 2 3.74 5 4.93 6 2.87 3 2.67 4-0.7 4-2.36 0-2.82 0-2.82 1 0 5-5.34 10-10.11 13-2.35 1-2.35 1-0.18-2zM12.8 1034c-1.44-2-1.54-2-1.54-2-1.24-2-3.112-4-3.112-4-2.871-3-2.671-4 0.697-4 2.365 0 2.825 0 2.825-1 0-5 4.09-10 10.68-13 4.35-1 2.83-1-0.39 2-1.81 3-3.83 7-3.84 11 0 1 0.43 1 2.82 1 3.37 0 3.57 1 0.7 4 0 0 0 0-3.12 4-0.62 1 0 0-1.53 2-0.85 1-1.79 2-2.1 2-0.31 0-1.25-1-2.09-2z" fill="#333"/></g></svg> <input type="checkbox" id="infini-scroll" name="infini-scroll" checked="checked" data-control="setting"/></label></div><script>(function() {
    "use strict";
    function FastClick(layer, options) {
        var oldOnClick;
        options = options || {};
        this.trackingClick = false;
        this.trackingClickStart = 0;
        this.targetElement = null;
        this.touchStartX = 0;
        this.touchStartY = 0;
        this.lastTouchIdentifier = 0;
        this.touchBoundary = options.touchBoundary || 10;
        this.layer = layer;
        this.tapDelay = options.tapDelay || 200;
        this.tapTimeout = options.tapTimeout || 700;
        if (FastClick.notNeeded(layer)) {
            return;
        }
        function bind(method, context) {
            return function() {
                return method.apply(context, arguments);
            };
        }
        var methods = [ "onMouse", "onClick", "onTouchStart", "onTouchMove", "onTouchEnd", "onTouchCancel" ];
        var context = this;
        for (var i = 0, l = methods.length; i < l; i++) {
            context[methods[i]] = bind(context[methods[i]], context);
        }
        if (deviceIsAndroid) {
            layer.addEventListener("mouseover", this.onMouse, true);
            layer.addEventListener("mousedown", this.onMouse, true);
            layer.addEventListener("mouseup", this.onMouse, true);
        }
        layer.addEventListener("click", this.onClick, true);
        layer.addEventListener("touchstart", this.onTouchStart, false);
        layer.addEventListener("touchmove", this.onTouchMove, false);
        layer.addEventListener("touchend", this.onTouchEnd, false);
        layer.addEventListener("touchcancel", this.onTouchCancel, false);
        if (!Event.prototype.stopImmediatePropagation) {
            layer.removeEventListener = function(type, callback, capture) {
                var rmv = Node.prototype.removeEventListener;
                if (type === "click") {
                    rmv.call(layer, type, callback.hijacked || callback, capture);
                } else {
                    rmv.call(layer, type, callback, capture);
                }
            };
            layer.addEventListener = function(type, callback, capture) {
                var adv = Node.prototype.addEventListener;
                if (type === "click") {
                    adv.call(layer, type, callback.hijacked || (callback.hijacked = function(event) {
                        if (!event.propagationStopped) {
                            callback(event);
                        }
                    }), capture);
                } else {
                    adv.call(layer, type, callback, capture);
                }
            };
        }
        if (typeof layer.onclick === "function") {
            oldOnClick = layer.onclick;
            layer.addEventListener("click", function(event) {
                oldOnClick(event);
            }, false);
            layer.onclick = null;
        }
    }
    var deviceIsWindowsPhone = navigator.userAgent.indexOf("Windows Phone") >= 0;
    var deviceIsAndroid = navigator.userAgent.indexOf("Android") > 0 && !deviceIsWindowsPhone;
    var deviceIsIOS = /iP(ad|hone|od)/.test(navigator.userAgent) && !deviceIsWindowsPhone;
    var deviceIsIOS4 = deviceIsIOS && /OS 4_\d(_\d)?/.test(navigator.userAgent);
    var deviceIsIOSWithBadTarget = deviceIsIOS && /OS [6-7]_\d/.test(navigator.userAgent);
    var deviceIsBlackBerry10 = navigator.userAgent.indexOf("BB10") > 0;
    FastClick.prototype.needsClick = function(target) {
        switch (target.nodeName.toLowerCase()) {
          case "button":
          case "select":
          case "textarea":
            if (target.disabled) {
                return true;
            }
            break;

          case "input":
            if (deviceIsIOS && target.type === "file" || target.disabled) {
                return true;
            }
            break;

          case "label":
          case "iframe":
          case "video":
            return true;
        }
        return /\bneedsclick\b/.test(target.className);
    };
    FastClick.prototype.needsFocus = function(target) {
        switch (target.nodeName.toLowerCase()) {
          case "textarea":
            return true;

          case "select":
            return !deviceIsAndroid;

          case "input":
            switch (target.type) {
              case "button":
              case "checkbox":
              case "file":
              case "image":
              case "radio":
              case "submit":
                return false;
            }
            return !target.disabled && !target.readOnly;

          default:
            return /\bneedsfocus\b/.test(target.className);
        }
    };
    FastClick.prototype.sendClick = function(targetElement, event) {
        var clickEvent, touch;
        if (document.activeElement && document.activeElement !== targetElement) {
            document.activeElement.blur();
        }
        touch = event.changedTouches[0];
        clickEvent = document.createEvent("MouseEvents");
        clickEvent.initMouseEvent(this.determineEventType(targetElement), true, true, window, 1, touch.screenX, touch.screenY, touch.clientX, touch.clientY, false, false, false, false, 0, null);
        clickEvent.forwardedTouchEvent = true;
        targetElement.dispatchEvent(clickEvent);
    };
    FastClick.prototype.determineEventType = function(targetElement) {
        if (deviceIsAndroid && targetElement.tagName.toLowerCase() === "select") {
            return "mousedown";
        }
        return "click";
    };
    FastClick.prototype.focus = function(targetElement) {
        var length;
        if (deviceIsIOS && targetElement.setSelectionRange && targetElement.type.indexOf("date") !== 0 && targetElement.type !== "time" && targetElement.type !== "month") {
            length = targetElement.value.length;
            targetElement.setSelectionRange(length, length);
        } else {
            targetElement.focus();
        }
    };
    FastClick.prototype.updateScrollParent = function(targetElement) {
        var scrollParent, parentElement;
        scrollParent = targetElement.fastClickScrollParent;
        if (!scrollParent || !scrollParent.contains(targetElement)) {
            parentElement = targetElement;
            do {
                if (parentElement.scrollHeight > parentElement.offsetHeight) {
                    scrollParent = parentElement;
                    targetElement.fastClickScrollParent = parentElement;
                    break;
                }
                parentElement = parentElement.parentElement;
            } while (parentElement);
        }
        if (scrollParent) {
            scrollParent.fastClickLastScrollTop = scrollParent.scrollTop;
        }
    };
    FastClick.prototype.getTargetElementFromEventTarget = function(eventTarget) {
        if (eventTarget.nodeType === Node.TEXT_NODE) {
            return eventTarget.parentNode;
        }
        return eventTarget;
    };
    FastClick.prototype.onTouchStart = function(event) {
        var targetElement, touch, selection;
        if (event.targetTouches.length > 1) {
            return true;
        }
        targetElement = this.getTargetElementFromEventTarget(event.target);
        touch = event.targetTouches[0];
        if (deviceIsIOS) {
            selection = window.getSelection();
            if (selection.rangeCount && !selection.isCollapsed) {
                return true;
            }
            if (!deviceIsIOS4) {
                if (touch.identifier && touch.identifier === this.lastTouchIdentifier) {
                    event.preventDefault();
                    return false;
                }
                this.lastTouchIdentifier = touch.identifier;
                this.updateScrollParent(targetElement);
            }
        }
        this.trackingClick = true;
        this.trackingClickStart = event.timeStamp;
        this.targetElement = targetElement;
        this.touchStartX = touch.pageX;
        this.touchStartY = touch.pageY;
        if (event.timeStamp - this.lastClickTime < this.tapDelay) {
            event.preventDefault();
        }
        return true;
    };
    FastClick.prototype.touchHasMoved = function(event) {
        var touch = event.changedTouches[0], boundary = this.touchBoundary;
        if (Math.abs(touch.pageX - this.touchStartX) > boundary || Math.abs(touch.pageY - this.touchStartY) > boundary) {
            return true;
        }
        return false;
    };
    FastClick.prototype.onTouchMove = function(event) {
        if (!this.trackingClick) {
            return true;
        }
        if (this.targetElement !== this.getTargetElementFromEventTarget(event.target) || this.touchHasMoved(event)) {
            this.trackingClick = false;
            this.targetElement = null;
        }
        return true;
    };
    FastClick.prototype.findControl = function(labelElement) {
        if (labelElement.control !== undefined) {
            return labelElement.control;
        }
        if (labelElement.htmlFor) {
            return document.getElementById(labelElement.htmlFor);
        }
        return labelElement.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea");
    };
    FastClick.prototype.onTouchEnd = function(event) {
        var forElement, trackingClickStart, targetTagName, scrollParent, touch, targetElement = this.targetElement;
        if (!this.trackingClick) {
            return true;
        }
        if (event.timeStamp - this.lastClickTime < this.tapDelay) {
            this.cancelNextClick = true;
            return true;
        }
        if (event.timeStamp - this.trackingClickStart > this.tapTimeout) {
            return true;
        }
        this.cancelNextClick = false;
        this.lastClickTime = event.timeStamp;
        trackingClickStart = this.trackingClickStart;
        this.trackingClick = false;
        this.trackingClickStart = 0;
        if (deviceIsIOSWithBadTarget) {
            touch = event.changedTouches[0];
            targetElement = document.elementFromPoint(touch.pageX - window.pageXOffset, touch.pageY - window.pageYOffset) || targetElement;
            targetElement.fastClickScrollParent = this.targetElement.fastClickScrollParent;
        }
        targetTagName = targetElement.tagName.toLowerCase();
        if (targetTagName === "label") {
            forElement = this.findControl(targetElement);
            if (forElement) {
                this.focus(targetElement);
                if (deviceIsAndroid) {
                    return false;
                }
                targetElement = forElement;
            }
        } else if (this.needsFocus(targetElement)) {
            if (event.timeStamp - trackingClickStart > 100 || deviceIsIOS && window.top !== window && targetTagName === "input") {
                this.targetElement = null;
                return false;
            }
            this.focus(targetElement);
            this.sendClick(targetElement, event);
            if (!deviceIsIOS || targetTagName !== "select") {
                this.targetElement = null;
                event.preventDefault();
            }
            return false;
        }
        if (deviceIsIOS && !deviceIsIOS4) {
            scrollParent = targetElement.fastClickScrollParent;
            if (scrollParent && scrollParent.fastClickLastScrollTop !== scrollParent.scrollTop) {
                return true;
            }
        }
        if (!this.needsClick(targetElement)) {
            event.preventDefault();
            this.sendClick(targetElement, event);
        }
        return false;
    };
    FastClick.prototype.onTouchCancel = function() {
        this.trackingClick = false;
        this.targetElement = null;
    };
    FastClick.prototype.onMouse = function(event) {
        if (!this.targetElement) {
            return true;
        }
        if (event.forwardedTouchEvent) {
            return true;
        }
        if (!event.cancelable) {
            return true;
        }
        if (!this.needsClick(this.targetElement) || this.cancelNextClick) {
            if (event.stopImmediatePropagation) {
                event.stopImmediatePropagation();
            } else {
                event.propagationStopped = true;
            }
            event.stopPropagation();
            event.preventDefault();
            return false;
        }
        return true;
    };
    FastClick.prototype.onClick = function(event) {
        var permitted;
        if (this.trackingClick) {
            this.targetElement = null;
            this.trackingClick = false;
            return true;
        }
        if (event.target.type === "submit" && event.detail === 0) {
            return true;
        }
        permitted = this.onMouse(event);
        if (!permitted) {
            this.targetElement = null;
        }
        return permitted;
    };
    FastClick.prototype.destroy = function() {
        var layer = this.layer;
        if (deviceIsAndroid) {
            layer.removeEventListener("mouseover", this.onMouse, true);
            layer.removeEventListener("mousedown", this.onMouse, true);
            layer.removeEventListener("mouseup", this.onMouse, true);
        }
        layer.removeEventListener("click", this.onClick, true);
        layer.removeEventListener("touchstart", this.onTouchStart, false);
        layer.removeEventListener("touchmove", this.onTouchMove, false);
        layer.removeEventListener("touchend", this.onTouchEnd, false);
        layer.removeEventListener("touchcancel", this.onTouchCancel, false);
    };
    FastClick.notNeeded = function(layer) {
        var metaViewport;
        var chromeVersion;
        var blackberryVersion;
        var firefoxVersion;
        if (typeof window.ontouchstart === "undefined") {
            return true;
        }
        chromeVersion = +(/Chrome\/([0-9]+)/.exec(navigator.userAgent) || [ , 0 ])[1];
        if (chromeVersion) {
            if (deviceIsAndroid) {
                metaViewport = document.querySelector("meta[name=viewport]");
                if (metaViewport) {
                    if (metaViewport.content.indexOf("user-scalable=no") !== -1) {
                        return true;
                    }
                    if (chromeVersion > 31 && document.documentElement.scrollWidth <= window.outerWidth) {
                        return true;
                    }
                }
            } else {
                return true;
            }
        }
        if (deviceIsBlackBerry10) {
            blackberryVersion = navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/);
            if (blackberryVersion[1] >= 10 && blackberryVersion[2] >= 3) {
                metaViewport = document.querySelector("meta[name=viewport]");
                if (metaViewport) {
                    if (metaViewport.content.indexOf("user-scalable=no") !== -1) {
                        return true;
                    }
                    if (document.documentElement.scrollWidth <= window.outerWidth) {
                        return true;
                    }
                }
            }
        }
        if (layer.style.msTouchAction === "none" || layer.style.touchAction === "manipulation") {
            return true;
        }
        firefoxVersion = +(/Firefox\/([0-9]+)/.exec(navigator.userAgent) || [ , 0 ])[1];
        if (firefoxVersion >= 27) {
            metaViewport = document.querySelector("meta[name=viewport]");
            if (metaViewport && (metaViewport.content.indexOf("user-scalable=no") !== -1 || document.documentElement.scrollWidth <= window.outerWidth)) {
                return true;
            }
        }
        if (layer.style.touchAction === "none" || layer.style.touchAction === "manipulation") {
            return true;
        }
        return false;
    };
    FastClick.attach = function(layer, options) {
        return new FastClick(layer, options);
    };
    if (typeof define === "function" && typeof define.amd === "object" && define.amd) {
        define(function() {
            return FastClick;
        });
    } else if (typeof module !== "undefined" && module.exports) {
        module.exports = FastClick.attach;
        module.exports.FastClick = FastClick;
    } else {
        window.FastClick = FastClick;
    }
})();

(function() {
    function G(a) {
        return typeof a == "string" ? a : null == a ? "" : a + "";
    }
    function ca(a) {
        return da[a];
    }
    function ea(a) {
        return "\\" + fa[a];
    }
    function s(a) {
        return a && typeof a == "object" || false;
    }
    function e(a) {
        if (s(a) && !x(a)) {
            if (a instanceof LodashWrapper) return a;
            if (q.call(a, "__wrapped__")) return new LodashWrapper(a.__wrapped__, a.__chain__, arrayCopy(a.__actions__));
        }
        return new LodashWrapper(a);
    }
    function R(a, b, c, d) {
        return typeof a != "undefined" && q.call(d, c) ? a : b;
    }
    function y(a, b, c) {
        var d = H(b);
        if (!c) {
            d || (d = a, a = {});
            c = -1;
            for (var e = d.length; ++c < e; ) {
                var g = d[c];
                a[g] = b[g];
            }
            return a;
        }
        e = -1;
        for (g = d.length; ++e < g; ) {
            var k = d[e], m = a[k], f = c(m, b[k], k, a, b);
            (f === f ? f === m : m !== m) && (typeof m != "undefined" || k in a) || (a[k] = f);
        }
        return a;
    }
    function ga(a, b) {
        for (var c = -1, d = b.length, e = Array(d); ++c < d; ) e[c] = a[b[c]];
        return e;
    }
    function I(a, b) {
        a = +a;
        b = null == b ? S : b;
        return -1 < a && 0 == a % 1 && a < b;
    }
    function ha(a, b, c) {
        if (!z(c)) return false;
        var d = typeof b;
        "number" == d ? (d = c.length, d = t(d) && I(b, d)) : d = "string" == d && b in c;
        return d && c[b] === a;
    }
    function t(a) {
        return typeof a == "number" && -1 < a && 0 == a % 1 && a <= S;
    }
    function T(a) {
        for (var b = U(a), c = b.length, d = c && a.length, g = e.support, g = d && t(d) && (x(a) || g.nonEnumStrings && J(a) || g.nonEnumArgs && A(a)), f = -1, k = []; ++f < c; ) {
            var m = b[f];
            (g && I(m, d) || q.call(a, m)) && k.push(m);
        }
        return k;
    }
    function A(a) {
        return t(s(a) ? a.length : K) && r.call(a) == V || false;
    }
    function L(a) {
        return s(a) && typeof a.message == "string" && r.call(a) == M || false;
    }
    function z(a) {
        var b = typeof a;
        return "function" == b || a && "object" == b || false;
    }
    function B(a) {
        return null == a ? false : r.call(a) == W ? X.test(ia.call(a)) : s(a) && (ja(a) ? X : ka).test(a) || !1;
    }
    function J(a) {
        return typeof a == "string" || s(a) && r.call(a) == N || false;
    }
    function U(a) {
        if (null == a) return [];
        z(a) || (a = Object(a));
        for (var b = a.length, c = e.support, b = b && t(b) && (x(a) || c.nonEnumStrings && J(a) || c.nonEnumArgs && A(a)) && b || 0, d = a.constructor, f = -1, d = typeof d == "function" && d.prototype || u, l = d === a, k = Array(b), m = 0 < b, p = c.enumErrorProps && (a === C || a instanceof Error), h = c.enumPrototypes && typeof a == "function"; ++f < b; ) k[f] = f + "";
        for (var n in a) h && "prototype" == n || p && ("message" == n || "name" == n) || m && I(n, b) || "constructor" == n && (l || !q.call(a, n)) || k.push(n);
        if (c.nonEnumShadows && a !== u) for (b = a === la ? N : a === C ? M : r.call(a), 
        c = g[b] || g[O], b == O && (d = u), b = P.length; b--; ) n = P[b], f = c[n], l && f || (f ? !q.call(a, n) : a[n] === d[n]) || k.push(n);
        return k;
    }
    function Y(a) {
        return (a = G(a)) && ma.test(a) ? a.replace(Z, "\\$&") : a;
    }
    function $(a) {
        try {
            return a();
        } catch (b) {
            return L(b) ? b : Error(b);
        }
    }
    var K, V = "[object Arguments]", M = "[object Error]", W = "[object Function]", O = "[object Object]", N = "[object String]", na = /\b__p\+='';/g, oa = /\b(__p\+=)''\+/g, pa = /(__e\(.*?\)|\b__t\))\+'';/g, aa = /[&<>"'`]/g, qa = RegExp(aa.source), ba = /<%=([\s\S]+?)%>/g, ra = /\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g, ka = /^\[object .+?Constructor\]$/, D = /($^)/, Z = /[.*+?^${}()|[\]\/\\]/g, ma = RegExp(Z.source), sa = /\bthis\b/, ta = /['\n\r\u2028\u2029\\]/g, P = "constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "), da = {
        "&": "&amp;",
        "<": "&lt;",
        ">": "&gt;",
        '"': "&quot;",
        "'": "&#39;",
        "`": "&#96;"
    }, p = {
        function: true,
        object: true
    }, fa = {
        "\\": "\\",
        "'": "'",
        "\n": "n",
        "\r": "r",
        "\u2028": "u2028",
        "\u2029": "u2029"
    }, E = p[typeof window] && window !== (this && this.window) ? window : this, w = p[typeof exports] && exports && !exports.nodeType && exports, p = p[typeof module] && module && !module.nodeType && module, l = w && p && typeof global == "object" && global;
    !l || l.global !== l && l.window !== l && l.self !== l || (E = l);
    var l = p && p.exports === w && w, ja = function() {
        try {
            Object({
                toString: 0
            } + "");
        } catch (a) {
            return function() {
                return false;
            };
        }
        return function(a) {
            return typeof a.toString != "function" && typeof (a + "") == "string";
        };
    }(), ua = Array.prototype, C = Error.prototype, u = Object.prototype, la = String.prototype, ia = Function.prototype.toString, q = u.hasOwnProperty, r = u.toString, X = RegExp("^" + Y(r).replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") + "$"), v = u.propertyIsEnumerable, va = ua.splice, Q = B(Q = Array.isArray) && Q, F = B(F = Object.keys) && F, S = Math.pow(2, 53) - 1, g = {};
    g["[object Array]"] = g["[object Date]"] = g["[object Number]"] = {
        constructor: true,
        toLocaleString: true,
        toString: true,
        valueOf: true
    };
    g["[object Boolean]"] = g[N] = {
        constructor: true,
        toString: true,
        valueOf: true
    };
    g[M] = g[W] = g["[object RegExp]"] = {
        constructor: true,
        toString: true
    };
    g[O] = {
        constructor: true
    };
    (function(a, b) {
        for (var c = -1, d = a.length; ++c < d && false !== b(a[c], c, a); ) ;
        return a;
    })(P, function(a) {
        for (var b in g) if (q.call(g, b)) {
            var c = g[b];
            c[a] = q.call(c, a);
        }
    });
    var f = e.support = {};
    (function(a) {
        function b() {
            this.x = 1;
        }
        var c = {
            0: 1,
            length: 1
        }, d = [];
        b.prototype = {
            valueOf: 1,
            y: 1
        };
        for (var e in new b()) d.push(e);
        f.argsTag = r.call(arguments) == V;
        f.enumErrorProps = v.call(C, "message") || v.call(C, "name");
        f.enumPrototypes = v.call(b, "prototype");
        f.funcDecomp = !B(E.WinRTError) && sa.test(function() {
            return this;
        });
        f.funcNames = typeof Function.name == "string";
        f.nonEnumStrings = !v.call("x", 0);
        f.nonEnumShadows = !/valueOf/.test(d);
        f.spliceObjects = (va.call(c, 0, 1), !c[0]);
        f.unindexedChars = "xx" != "x"[0] + Object("x")[0];
        try {
            f.nonEnumArgs = !v.call(arguments, 1);
        } catch (g) {
            f.nonEnumArgs = true;
        }
    })(0, 0);
    e.templateSettings = {
        escape: /<%-([\s\S]+?)%>/g,
        evaluate: /<%([\s\S]+?)%>/g,
        interpolate: ba,
        variable: "",
        imports: {
            _: e
        }
    };
    f.argsTag || (A = function(a) {
        return t(s(a) ? a.length : K) && q.call(a, "callee") && !v.call(a, "callee") || false;
    });
    var x = Q || function(a) {
        return s(a) && t(a.length) && "[object Array]" == r.call(a) || false;
    }, H = F ? function(a) {
        if (a) var b = a.constructor, c = a.length;
        return typeof b == "function" && b.prototype === a || (typeof a == "function" ? e.support.enumPrototypes : c && t(c)) ? T(a) : z(a) ? F(a) : [];
    } : T;
    e.keys = H;
    e.keysIn = U;
    e.attempt = $;
    e.escape = function(a) {
        return (a = G(a)) && qa.test(a) ? a.replace(aa, ca) : a;
    };
    e.escapeRegExp = Y;
    e.isArguments = A;
    e.isArray = x;
    e.isError = L;
    e.isNative = B;
    e.isObject = z;
    e.isString = J;
    e.template = function(a, b, c) {
        var d = e.templateSettings;
        c && ha(a, b, c) && (b = c = null);
        a = G(a);
        b = y(y({}, c || b), d, R);
        c = y(y({}, b.imports), d.imports, R);
        var f = H(c), g = ga(c, f), k, m, l = 0;
        c = b.interpolate || D;
        var h = "__p+='", n = "sourceURL" in b ? "//# sourceURL=" + b.sourceURL + "\n" : "";
        a.replace(RegExp((b.escape || D).source + "|" + c.source + "|" + (c === ba ? ra : D).source + "|" + (b.evaluate || D).source + "|$", "g"), function(b, c, d, e, f, g) {
            d || (d = e);
            h += a.slice(l, g).replace(ta, ea);
            c && (k = true, h += "'+__e(" + c + ")+'");
            f && (m = true, h += "';" + f + ";\n__p+='");
            d && (h += "'+((__t=(" + d + "))==null?'':__t)+'");
            l = g + b.length;
            return b;
        });
        h += "';";
        (b = b.variable) || (h = "with(obj){" + h + "}");
        h = (m ? h.replace(na, "") : h).replace(oa, "$1").replace(pa, "$1;");
        h = "function(" + (b || "obj") + "){" + (b ? "" : "obj||(obj={});") + "var __t,__p=''" + (k ? ",__e=_.escape" : "") + (m ? ",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}" : ";") + h + "return __p}";
        b = $(function() {
            return Function(f, n + "return " + h).apply(K, g);
        });
        b.source = h;
        if (L(b)) throw b;
        return b;
    };
    e.VERSION = "3.1.0";
    typeof define == "function" && typeof define.amd == "object" && define.amd ? (E._ = e, 
    define(function() {
        return e;
    })) : w && p ? l ? (p.exports = e)._ = e : w._ = e : E._ = e;
}).call(this);

(function(fastdom) {
    "use strict";
    var raf = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.msRequestAnimationFrame || function(cb) {
        return window.setTimeout(cb, 1e3 / 60);
    };
    function FastDom() {
        this.frames = [];
        this.lastId = 0;
        this.raf = raf;
        this.batch = {
            hash: {},
            read: [],
            write: [],
            mode: null
        };
    }
    FastDom.prototype.read = function(fn, ctx) {
        var job = this.add("read", fn, ctx);
        var id = job.id;
        this.batch.read.push(job.id);
        var doesntNeedFrame = this.batch.mode === "reading" || this.batch.scheduled;
        if (doesntNeedFrame) return id;
        this.scheduleBatch();
        return id;
    };
    FastDom.prototype.write = function(fn, ctx) {
        var job = this.add("write", fn, ctx);
        var mode = this.batch.mode;
        var id = job.id;
        this.batch.write.push(job.id);
        var doesntNeedFrame = mode === "writing" || mode === "reading" || this.batch.scheduled;
        if (doesntNeedFrame) return id;
        this.scheduleBatch();
        return id;
    };
    FastDom.prototype.defer = function(frame, fn, ctx) {
        if (typeof frame === "function") {
            ctx = fn;
            fn = frame;
            frame = 1;
        }
        var self = this;
        var index = frame - 1;
        return this.schedule(index, function() {
            self.run({
                fn: fn,
                ctx: ctx
            });
        });
    };
    FastDom.prototype.clear = function(id) {
        if (typeof id === "function") {
            return this.clearFrame(id);
        }
        id = Number(id);
        var job = this.batch.hash[id];
        if (!job) return;
        var list = this.batch[job.type];
        var index = list.indexOf(id);
        delete this.batch.hash[id];
        if (~index) list.splice(index, 1);
    };
    FastDom.prototype.clearFrame = function(frame) {
        var index = this.frames.indexOf(frame);
        if (~index) this.frames.splice(index, 1);
    };
    FastDom.prototype.scheduleBatch = function() {
        var self = this;
        this.schedule(0, function() {
            self.batch.scheduled = false;
            self.runBatch();
        });
        this.batch.scheduled = true;
    };
    FastDom.prototype.uniqueId = function() {
        return ++this.lastId;
    };
    FastDom.prototype.flush = function(list) {
        var id;
        while (id = list.shift()) {
            this.run(this.batch.hash[id]);
        }
    };
    FastDom.prototype.runBatch = function() {
        try {
            this.batch.mode = "reading";
            this.flush(this.batch.read);
            this.batch.mode = "writing";
            this.flush(this.batch.write);
            this.batch.mode = null;
        } catch (e) {
            this.runBatch();
            throw e;
        }
    };
    FastDom.prototype.add = function(type, fn, ctx) {
        var id = this.uniqueId();
        return this.batch.hash[id] = {
            id: id,
            fn: fn,
            ctx: ctx,
            type: type
        };
    };
    FastDom.prototype.run = function(job) {
        var ctx = job.ctx || this;
        var fn = job.fn;
        delete this.batch.hash[job.id];
        if (!this.onError) {
            return fn.call(ctx);
        }
        try {
            fn.call(ctx);
        } catch (e) {
            this.onError(e);
        }
    };
    FastDom.prototype.loop = function() {
        var self = this;
        var raf = this.raf;
        if (this.looping) return;
        raf(function frame() {
            var fn = self.frames.shift();
            if (!self.frames.length) {
                self.looping = false;
            } else {
                raf(frame);
            }
            if (fn) fn();
        });
        this.looping = true;
    };
    FastDom.prototype.schedule = function(index, fn) {
        if (this.frames[index]) {
            return this.schedule(index + 1, fn);
        }
        this.loop();
        return this.frames[index] = fn;
    };
    fastdom = fastdom || new FastDom();
    if (typeof module !== "undefined" && module.exports) {
        module.exports = fastdom;
    } else if (typeof define === "function" && define.amd) {
        define(function() {
            return fastdom;
        });
    } else {
        window["fastdom"] = fastdom;
    }
})(window.fastdom);

"use strict";

var regPubMatch = /productNo(?:\.exact|\.raw)?(?=\:|$)/, regCheckInput = /[A-Za-z0-9\s\-\_\.\,\&]/g, regFixInput = /[^A-Za-z0-9\s\-\_\.\,\&]/g, regEmerge = / ?emerge/g, regHidden = / ?hidden/g, regLoad = / ?loading/g, regSelected = / ?selected/g, regOpened = / ?opened/g, regFail = / ?failed/g, regValidate = / ?invalidated/g, regQueryPubName = /(?:\b[\-_a-zA-Z]{1,3})?[ \t\-]*(?:(?:[\.\-]|[0-9]+)+)+(?:_?(?:sup|SUP)[A-Za-z]*)?/g, regEOLDashCheck = /[\-\cI\v\0\f]$/m, regPreTitle = /(?:\W?)\w\S*/g;

function addEvent(element, evt, fnc) {
    return element.addEventListener(evt, fnc, false);
}

function removeEvent(element, evt, fnc) {
    return element.removeEventListener(evt, fnc, false);
}

function swapClass(element, string, regex) {
    if (string !== "" && typeof string === "string") {
        fastdom.write(function() {
            var className = element.className;
            if (regex.test(className)) {
                return false;
            }
            element.className += " " + string;
        });
    } else {
        fastdom.write(function() {
            element.className = element.className.replace(regex, "");
        });
    }
}

function txt(string) {
    if (string && typeof string === "string" && string.length > 0) {
        return document.createTextNode(string);
    }
}

String.prototype.toTitle = function() {
    return this.replace(regPreTitle, function(txt) {
        return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();
    });
};

String.prototype.toPubName = function() {
    var removed, count = 0, extraction = [];
    removed = this.replace(regQueryPubName, function(txt) {
        if (extraction && extraction.length > 0 && regEOLDashCheck.test(extraction[count - 1])) {
            extraction[count - 1] += txt.toUpperCase().replace(/\s/g, "");
        } else {
            extraction.push(txt.toUpperCase().replace(/\s/g, ""));
        }
        count += 1;
        return "";
    });
    return {
        remove: removed,
        extract: extraction
    };
};

CSSStyleSheet.prototype.addCSSRule = function(selector, rules, index) {
    if ("insertRule" in this) {
        this.insertRule(selector + "{" + rules + "}", index);
    } else if ("addRule" in this) {
        this.addRule(selector, rules, index);
    }
};

window.downloader = function(el) {
    var link = document.createElement("a"), file = el.href || el.getAttribute("href") || "";
    if (file === "") {
        return false;
    }
    link.download = el.download || el.getAttribute("download");
    link.href = file;
    link.target = "_blank";
    try {
        link.click();
    } catch (e) {
        try {
            window.open(file);
        } catch (ee) {
            window.location.href = file;
        }
    }
    return false;
};

var months = {
    "01": "Jan",
    "02": "Feb",
    "03": "Mar",
    "04": "Apr",
    "05": "May",
    "06": "Jun",
    "07": "Jul",
    "08": "Aug",
    "09": "Sep",
    "10": "Oct",
    "11": "Nov",
    "12": "Dec"
};

function querySetup(term) {
    if (!term) return {
        term: "",
        pubName: "",
        noPubName: ""
    };
    return function(name) {
        return {
            term: term,
            pubName: name.extract,
            noPubName: name.remove
        };
    }(term.toPubName());
}

function filterOutliers(someArray) {
    var values = someArray.concat();
    values.sort(function(a, b) {
        return a - b;
    });
    var q1 = values[Math.floor(values.length / 4)];
    var q3 = values[Math.ceil(values.length * (3 / 4))];
    var iqr = q3 - q1;
    var maxValue = q3 + iqr * 1.5;
    return values.filter(function(x) {
        return x > maxValue;
    });
}

function upperOutlier(someArray) {
    var values = someArray.concat();
    values.sort(function(a, b) {
        return a - b;
    });
    var q1 = values[Math.floor(values.length / 4)];
    var q3 = values[Math.ceil(values.length * (3 / 4))];
    var iqr = q3 - q1;
    var maxValue = q3 + iqr * 1.5;
    return maxValue;
}

var relatedTemplateString = "" + '<li class="result doc<%= gravitas %>" data-score="<%= score %>" id="<%= key %>">' + "<%= key %>" + "</li>";

var resultTemplateString = "" + '<div class="result<%= type %><%= gravitas %> clearfix" data-score="<%= score %>" data-pub="<%= fullPub %>">' + '<% if ( type === " content" ) { %>' + '<div class="text clearfix">' + "<% if ( parts && concatText ) { %>" + '<span class="combined"><%= concatText %><br/></span>' + '<span class="parts"><%  var i = 0, count = parts.length;' + "for (; i < count; ++i) {" + "if ( count > 1 || concatText.length > parts[0].length ) { %>" + "<q>...<%= parts[i] %>...</q>" + "<% } else { %>" + "<%= parts[0] %>" + "<% } %>" + "<% } %></span>" + '<% if ( count > 1 || concatText.length > parts[0].length ) { %><a href="#" class="reveal-text clickable">expand</a><% } %>' + "<% } else { %>" + '<span class="combined"><%= rawText %></span>' + '<span class="parts"></span>' + '<a href="#" class="reveal-text clickable">expand</a>' + "<% } %>" + "</div>" + '<div class="meta">' + '<div class="details">' + '<span class="number"><%= sub %></span><br/>' + "<% if ( details && details.chapter && details.chapterTitle ) { %>" + '<span class="chapter">Chapter <%= details.chapter %><br/><span class="title"><%= details.chapterTitle %></span></span><br/>' + "<% } if ( details && details.section && details.sectionTitle ) { %>" + '<span class="section">Section <%= details.section %><br/><span class="title"><%= details.sectionTitle %></span></span><br/>' + "<% } %>" + "</div>" + '<a class="info clickable" href="<%= url %>" title="<%= date %>" download="<%= fullPub %>.pdf" target="_blank">' + '<span class="pub"><%= fullPub %></span><br/>' + '<span class="title"><%= title %></span>' + "</a>" + "</div>" + "<% } else { %>" + '<a class="info clickable" href="<%= url %>" title="<%= date %>" download="<%= fullPub %>.pdf" target="_blank">' + '<span class="pub"><%= fullPub %></span><br/>' + '<span class="title"><%= title %></span>' + "</a>" + "<% } %>" + "</div>";

var app = function(window, document, _, undefined) {
    "use strict";
    var loader_ = document.getElementById("loader"), searchWrap_ = document.getElementById("search-wrap"), wrap_ = document.getElementById("wrap"), page_ = document.getElementById("page"), searchRestore_ = document.getElementById("search-restore"), searchIcon_ = document.getElementById("ico"), xIcon_ = document.getElementById("x"), pageHeader_ = document.getElementById("page-header"), related_ = document.getElementById("related-list"), results_ = document.getElementById("results"), count_ = document.getElementById("count"), term_ = document.getElementById("term"), total_ = document.getElementById("total"), message_ = document.getElementById("message"), query_ = document.getElementById("query"), send_ = document.getElementById("send"), moreContent_ = document.getElementById("more-content"), infiniLabel_ = document.getElementById("infini-label"), infiniScroll_ = document.getElementById("infini-scroll"), placeContent = document.cookie.placeContent || "", placeMeta = document.cookie.placeMeta || "", bodyRect, relatedRect, resultsRect, relatedOffsetTop, stickyBarPosition;
    return {
        loader_: loader_,
        searchWrap_: searchWrap_,
        wrap_: wrap_,
        page_: page_,
        searchRestore_: searchRestore_,
        searchIcon_: searchIcon_,
        xIcon_: xIcon_,
        pageHeader_: pageHeader_,
        related_: related_,
        results_: results_,
        count_: count_,
        term_: term_,
        total_: total_,
        message_: message_,
        query_: query_,
        send_: send_,
        moreContent_: moreContent_,
        placeContent: placeContent,
        placeMeta: placeMeta,
        infiniLabel_: infiniLabel_,
        infiniScroll_: infiniScroll_,
        relatedTemplate: _.template(relatedTemplateString),
        resultTemplate: _.template(resultTemplateString),
        infiniScroll: true,
        loading: {
            now: false,
            stillMore: false,
            currentHeight: 0
        },
        bodyRect: bodyRect,
        relatedRect: relatedRect,
        resultsRect: resultsRect,
        relatedOffsetTop: relatedOffsetTop,
        stickyBarPosition: stickyBarPosition,
        traveling: false,
        pos: 0,
        term: "",
        scoresContent: [],
        scoresRelatives: [],
        selectedResults: [],
        selectedTotal: 0,
        colors: {},
        isSearchBoxOpen: null,
        isFailure: null,
        isDone: false,
        organizeData: function(data, allScores, upperMax) {
            var output = {}, regType = /chapter|section/, index, group, number, fullPub, rawText, text, date, highlights, fileFormat;
            if (!data._source && data.key && data.score) {
                index = allScores.indexOf(data.score);
                group = index > -1 ? " match-" + index : "";
                app.colors[data.key] = index;
                output = {
                    key: data.key,
                    url: document.location.protocol + "//get.that.pub/" + data.key.toLowerCase() + ".pdf",
                    score: data.score,
                    gravitas: upperMax < data.score || data.score >= 1 ? " pretty" + group : " boring" + group
                };
            } else if (data._source.text) {
                number = data._source.number;
                text = data.highlight["text.english2"];
                rawText = data._source.text;
                fullPub = data._source.productNo;
                highlights = Object.keys(data.highlight);
                fileFormat = data._type !== "form" ? ".pdf" : ".xfdl";
                if (regPubMatch.test(highlights.join(":"))) {
                    fullPub = data.highlight["productNo.exact"] || data.highlight["productNo.raw"] || data.highlight.productNo;
                    fullPub = fullPub.shift();
                }
                date = data._source.releaseDate ? data._source.releaseDate.substring(6, 8) + " " + months[data._source.releaseDate.substring(4, 6)] + " " + data._source.releaseDate.substring(0, 4) : data._source.publishedDate.substring(0, 2) + " " + months[data._source.publishedDate.substring(2, 4)] + " " + data._source.publishedDate.substring(4, 8);
                if (regType.test(data._type) && data._type.length == 7) {
                    number = data._type.toTitle() + " " + data._source.number;
                }
                index = app.colors[data._source.productNo || data._source.pubName];
                group = index && typeof index === "number" && (index >= 0 || index < 5) ? " match-" + index : "";
                output = {
                    score: data._score,
                    gravitas: upperMax < data.score || data.score >= 1 ? " pretty" + group : " boring" + group,
                    date: date,
                    url: document.location.protocol + "//get.that.pub/" + data._source.productNo.toLowerCase() + fileFormat,
                    fullPub: fullPub,
                    title: data.highlight.title || data._source.title || null,
                    rawTitle: data._source.title,
                    sub: rawText ? number : "",
                    details: {
                        chapter: data._source.chapter && data._source.chapter.number || null,
                        chapterTitle: data.highlight["chapter.title"] || data._source.chapter && data._source.chapter.title || null,
                        section: data._source.section && data._source.section.number || null,
                        sectionTitle: data.highlight["section.title"] || data._source.section && data._source.section.title || null
                    },
                    rawText: rawText,
                    concatText: data.highlight.text && data.highlight.text[0] || null,
                    parts: Array.isArray(text) ? text : null,
                    fileFormat: fileFormat,
                    type: rawText ? " content" : " doc"
                };
            }
            return output || null;
        },
        renderResults: function(itemType, results) {
            var stringToRender = "", objWithData = {}, rl = results.length, a = 0, upperMax, templateCode, scores;
            if (itemType === "results") {
                templateCode = this.resultTemplate;
                scores = this.scoresContent;
                upperMax = upperOutlier(scores);
            } else {
                templateCode = this.relatedTemplate;
                scores = this.scoresRelatives;
                upperMax = upperOutlier(scores);
            }
            for (;a < rl; ++a) {
                objWithData = this.organizeData(results[a], scores, upperMax);
                stringToRender += templateCode(objWithData);
            }
            return stringToRender;
        },
        searchBoxToggle: function(action) {
            var that = this;
            if (action === "close") {
                this.infiniScroll = this.infiniScroll_ ? this.infiniScroll_.checked || !!this.infiniScroll_.checked : true;
                this.term = this.query_.value.trim();
                swapClass(this.searchWrap_, "", regEmerge);
                swapClass(this.searchWrap_, "", regFail);
                fastdom.write(function() {
                    that.searchIcon_.style.display = "";
                    that.xIcon_.style.display = "none";
                    that.message_.innerHTML = "";
                });
                this.isSearchBoxOpen = false;
            } else if (action === "open") {
                fastdom.write(function() {
                    that.query_.value = that.term;
                    that.searchIcon_.style.display = "none";
                    that.xIcon_.style.display = "";
                });
                swapClass(this.searchWrap_, "emerge", regEmerge);
                if (this.isFailure === true) {
                    this.isFailure = false;
                    swapClass(this.searchWrap_, "failed", regFail);
                }
                this.isSearchBoxOpen = true;
                this.infiniScroll = false;
            }
        }
    };
}(this, this.document, _);

(function(window, document, app, undefined) {
    "use strict";
    app.revealText = function(event) {
        var that = event.currentTarget || event.srcElement || event.target, open;
        event.preventDefault();
        open = that.getAttribute("data-opened");
        if (open !== "true") {
            fastdom.write(function() {
                swapClass(that.parentNode, "opened", regOpened);
                that.innerHTML = "consolidate";
                that.setAttribute("data-opened", "true");
            });
        } else {
            fastdom.write(function() {
                swapClass(that.parentNode, "", regOpened);
                that.innerHTML = "expand";
                that.setAttribute("data-opened", "false");
            });
        }
        return false;
    };
    app.more = function(event) {
        if (event && event.preventDefault) {
            event.preventDefault();
        }
        if (app.loading.now !== true) {
            swapClass(app.loader_, "loading", regLoad);
        }
        app.submitQuery("content", "more", document.cookie.placeContent || app.placeContent, null);
        return false;
    };
    app.infini = function(event) {
        var status, doThis;
        app.infiniScroll = this.checked || !!this.checked;
        status = app.infiniScroll ? "enabled" : "disabled";
        doThis = app.infiniScroll ? "Disable" : "Enable";
        app.infiniLabel_.className = status;
        app.infiniLabel_.setAttribute("title", doThis + " infinite scroll");
        if (!status) {
            this.removeAttribute("checked");
        }
    };
    app.scrollWheeler = function(event) {
        fastdom.read(function() {
            var pos = (rootElement && typeof rootElement.ScrollTop === "number" ? rootElement : document.body).ScrollTop || window.pageYOffset, delta = pos - app.pos;
            if (app.infiniScroll === true && app.loading.now === false && app.loading.stillMore === true && delta > 0 && pos > app.loading.currentHeight - 1200) {
                app.loading.now = true;
                app.more();
            }
            app.pos = pos;
        });
    };
    app.searchStart = function(event) {
        event && event.preventDefault && event.preventDefault();
        var that = this, val = app.query_.value.trim();
        app.isFailure = false;
        app.isDone = false;
        if (!val) {
            app.queryInvalidated = true;
            swapClass(app.query_, "invalidated", regValidate);
            fastdom.write(function() {
                that.message_.innerHTML = "You gotta type something first.";
                that.query_.focus();
            });
            return false;
        }
        app.term = val;
        swapClass(app.loader_, "loading", regLoad);
        app.submitQuery("content", "search", app.placeContent, app.placeMeta);
        return false;
    };
})(this, this.document, app);

(function(window, document, app, undefined) {
    "use strict";
    app.handleResponse = function(httpRequest, action) {
        var that = this, response = JSON.parse(httpRequest.responseText), content = response[0] || null, meta = response[1] || null, expires, a = 0, b = 0, reveals, rl;
        this.isDone = true;
        if (content && content.hits.total === 0 && (meta && meta.hits.total === 0)) {
            this.isFailure = true;
            this.infiniScroll = false;
            document.cookie = "placeContent=;expires=Thu, 01 Jan 1970 00:00:01 GMT;";
            document.cookie = "placeMeta=;expires=Thu, 01 Jan 1970 00:00:01 GMT;";
            fastdom.write(function() {
                that.message_.innerHTML = "Your search returned no results.  Give 'er another go.";
            });
            swapClass(this.loader_, "", regLoad);
            this.xIcon_.style.display = "none";
            swapClass(this.searchWrap_, "failed", regFail);
            return false;
        }
        expires = new Date(Date.now() + 6e4);
        expires = expires.toUTCString();
        fastdom.defer(function() {
            if (that.resetSearch) {
                clearTimeout(that.resetSearch);
            }
            that.resetSearch = setTimeout(function() {
                swapClass(that.moreContent_, "hidden", regHidden);
                that.loading.stillMore = false;
            }, 6e4);
        });
        if (content) {
            var currentContent = content.hits.hits.length;
            this.placeContent = content._scroll_id;
            document.cookie = "placeContent=" + this.placeContent + "; expires=" + expires;
            if (action !== "more") {
                var currentRelatives = content.aggregations.related_doc.buckets.length;
                window.scroll(0, 0);
                b = 0;
                for (;b < currentContent; ++b) {
                    this.scoresContent[b] = content.hits.hits[b]._score;
                }
                for (b = 0; b < currentRelatives; ++b) {
                    this.scoresRelatives[b] = content.aggregations.related_doc.buckets[b].score;
                }
                fastdom.write(function() {
                    that.term_.innerHTML = that.term;
                    that.count_.innerHTML = content.hits.hits.length;
                    that.total_.innerHTML = content.hits.total;
                    that.related_.innerHTML = that.renderResults("relatives", content.aggregations.related_doc.buckets);
                    that.results_.innerHTML = that.renderResults("results", content.hits.hits);
                });
            } else {
                for (b = 0; b < currentContent; ++b) {
                    this.scoresContent.push(content.hits.hits[b]._score);
                }
                fastdom.write(function() {
                    that.count_.innerHTML = that.scoresContent.length;
                    that.results_.innerHTML += that.renderResults("results", content.hits.hits);
                });
            }
            fastdom.defer(function() {
                that.relatedRect = that.related_.getBoundingClientRect();
                that.bodyRect = document.body.getBoundingClientRect();
                that.stickyBarPosition = Math.abs(that.relatedRect.top) + Math.abs(that.bodyRect.top) + Math.abs(that.relatedRect.height);
            });
            fastdom.defer(function() {
                reveals = that.results_.querySelectorAll(".reveal-text");
                rl = reveals.length;
                a = 0;
                for (;a < rl; ++a) {
                    addEvent(reveals[a], "click", that.revealText);
                }
            });
            if (content.hits.hits.length < 20) {
                this.loading.stillMore = false;
                swapClass(this.moreContent_, "hidden", regHidden);
            } else {
                this.loading.stillMore = true;
                swapClass(this.moreContent_, "", regHidden);
            }
        }
        if (meta) {
            this.placeMeta = meta._scroll_id;
            document.cookie = "placeMeta=" + this.placeMeta + "; expires=" + expires;
        }
        fastdom.defer(function() {
            that.resultsRect = that.results_.getBoundingClientRect();
            that.loading.currentHeight = Math.abs(that.resultsRect.height);
            that.loading.now = false;
        });
        this.searchBoxToggle("close");
        swapClass(this.loader_, "", regLoad);
    };
    app.submitQuery = function(type, action, contentPager, metaPager) {
        var that = this, request = new XMLHttpRequest(), query = this.term, url = "//that.pub/find/" + type + "/" + action, data = {
            t: querySetup(query),
            g: contentPager,
            s: metaPager
        }, dataString = JSON.stringify(data);
        request.onreadystatechange = function() {
            if (request.readyState === 4 && request.status === 200) {
                that.handleResponse(request, action);
            }
        };
        request.open("POST", url, true);
        request.setRequestHeader("Content-type", "application/json");
        request.send(dataString);
    };
})(this, this.document, app);

(function(window, document, app, undefined) {
    "use strict";
    addEvent(app.send_, "click", app.searchStart);
    addEvent(app.query_, "focus", function() {
        if (app.queryInvalidated !== true) {
            return false;
        }
    });
    addEvent(app.query_, "keypress", function(event) {
        if (app.queryInvalidated === true) {
            app.queryInvalidated = false;
            swapClass(app.query_, "", regValidate);
            app.message_.innerHTML = "";
        }
        if (event.which === 13 && app.isSearchBoxOpen === true) {
            app.searchStart(event);
            return false;
        }
    });
    addEvent(document, "keyup", function(event) {
        if (event.which === 27) {
            event.preventDefault();
            if (app.isSearchBoxOpen === true && app.isFailure !== true) {
                app.searchBoxToggle("close");
            }
        }
    });
    addEvent(app.moreContent_, "click", app.more);
    addEvent(app.searchRestore_, "click", function(event) {
        event.preventDefault();
        if (app.isSearchBoxOpen === true) {
            if (app.isDone === true && app.isFailure !== true) {
                app.searchBoxToggle("close");
            } else {
                return false;
            }
        } else {
            app.searchBoxToggle("open");
            app.query_.value = app.term;
            app.query_.focus();
        }
        return false;
    });
    addEvent(app.infiniScroll_, "change", app.infini);
    addEvent(window, "scroll", app.scrollWheeler);
    addEvent(window, "load", function() {
        app.isSearchBoxOpen = true;
        app.isDone = false;
        app.query_.focus();
    });
    addEvent(document, "DOMContentLoaded", function() {
        FastClick.attach(app.wrap_);
    });
})(this, this.document, app);
//# sourceMappingURL=script.js.map</script><script>;(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b;a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)};a[b].l=1*new Date;c=e.createElement(f);d=e.getElementsByTagName(f)[0];c.async=1;c.src=g;d.parentNode.insertBefore(c,d)})(window,document,"script","//www.google-analytics.com/analytics.js","ga");ga("create","UA-57324413-1","auto");ga("send","pageview");</script></body></html>