"use strict";function addEvent(a,b,c){return a.addEventListener(b,c,!1)}function removeEvent(a,b,c){return a.removeEventListener(b,c,!1)}function swapClass(a,b,c){""!==b&&"string"==typeof b?fastdom.write(function(){var d=a.className;return c.test(d)?!1:void(a.className+=" "+b)}):fastdom.write(function(){a.className=a.className.replace(c,"")})}function txt(a){return a&&"string"==typeof a&&a.length>0?document.createTextNode(a):void 0}function querySetup(a){return a?function(b){return{term:a,pubName:b.extract,noPubName:b.remove}}(a.toPubName()):{term:"",pubName:"",noPubName:""}}function filterOutliers(a){var b=a.concat();b.sort(function(a,b){return a-b});var c=b[Math.floor(b.length/4)],d=b[Math.ceil(.75*b.length)],e=d-c,f=d+1.5*e;return b.filter(function(a){return a>f})}function upperOutlier(a){var b=a.concat();b.sort(function(a,b){return a-b});var c=b[Math.floor(b.length/4)],d=b[Math.ceil(.75*b.length)],e=d-c,f=d+1.5*e;return f}function revealText(a){var b,c=this;return a.preventDefault(),b=c.getAttribute("data-opened"),"true"!==b?fastdom.write(function(){swapClass(c.parentNode,"opened",regOpened),c.innerHTML="consolidate",c.setAttribute("data-opened","true")}):fastdom.write(function(){swapClass(c.parentNode,"",regOpened),c.innerHTML="expand",c.setAttribute("data-opened","false")}),!1}function endLoading(){return app.loading.now=!1,app.loading.init=!1,swapClass(app.loader_,"",regLoad),app.isFailure!==!0&&app.searchBoxToggle("close"),!1}function modalClose(a){a.target===a.currentTarget&&app.searchBoxToggle("close")}function more(a){return a&&a.preventDefault&&a.preventDefault(),app.loading.now!==!0&&swapClass(app.loader_,"loading",regLoad),submitQuery("content","more",document.cookie.placeContent||app.placeContent,null),!1}function infini(){var a,b;app.infiniScroll=this.checked||!!this.checked,a=app.infiniScroll?"enabled":"disabled",b=app.infiniScroll?"Disable":"Enable",app.infiniLabel_.className=a,app.infiniLabel_.setAttribute("title",b+" infinite scroll"),a||this.removeAttribute("checked")}function scrollWheeler(){fastdom.read(function(){var a=(rootElement&&"number"==typeof rootElement.ScrollTop?rootElement:document.body).ScrollTop||window.pageYOffset,b=a-app.pos;app.infiniScroll===!0&&app.loading.now===!1&&app.loading.stillMore===!0&&b>0&&a>app.loading.currentHeight-1200&&(app.loading.now=!0,more()),app.pos=a})}function searchStart(a){a&&a.preventDefault&&a.preventDefault();var b=app.query_.value.trim();return app.isFailure=!1,app.isDone=!1,b?(app.term=b,swapClass(app.loader_,"loading",regLoad),submitQuery("content","search",app.placeContent,app.placeMeta),!1):(app.queryInvalidated=!0,swapClass(app.query_,"invalidated",regValidate),fastdom.write(function(){app.message_.innerHTML="You gotta type something first.",app.query_.focus()}),!1)}function handleResponse(a,b){var c,d,e,f=JSON.parse(a.responseText),g=f[0]||null,h=f[1]||null,i=0,j=0;if(app.isDone=!0,g&&0===g.hits.total&&h&&0===h.hits.total)return app.isFailure=!0,app.infiniScroll=!1,document.cookie="placeContent=;expires=Thu, 01 Jan 1970 00:00:01 GMT;",document.cookie="placeMeta=;expires=Thu, 01 Jan 1970 00:00:01 GMT;",fastdom.write(function(){app.message_.innerHTML="Your search returned no results.  Give 'er another go."}),swapClass(app.loader_,"",regLoad),app.xIcon_.style.display="none",swapClass(app.searchWrap_,"failed",regFail),!1;if(c=new Date(Date.now()+6e4),c=c.toUTCString(),fastdom.defer(function(){app.resetSearch&&clearTimeout(app.resetSearch),app.resetSearch=setTimeout(function(){swapClass(app.moreContent_,"hidden",regHidden),app.loading.stillMore=!1},6e4)}),g){var k=g.hits.hits.length;if(app.placeContent=g._scroll_id,document.cookie="placeContent="+app.placeContent+"; expires="+c,"more"!==b){var l=g.aggregations.related_doc.buckets.length;for(window.scroll(0,0),j=0;k>j;++j)app.scoresContent[j]=g.hits.hits[j]._score;for(j=0;l>j;++j)app.scoresRelatives[j]=g.aggregations.related_doc.buckets[j].score;fastdom.write(function(){app.term_.innerHTML=app.term,app.count_.innerHTML=g.hits.hits.length,app.total_.innerHTML=g.hits.total,app.related_.innerHTML=app.renderResults("relatives",g.aggregations.related_doc.buckets),app.results_.innerHTML=app.renderResults("results",g.hits.hits)})}else{for(j=0;k>j;++j)app.scoresContent.push(g.hits.hits[j]._score);fastdom.write(function(){app.count_.innerHTML=app.scoresContent.length,app.results_.innerHTML+=app.renderResults("results",g.hits.hits)})}fastdom.defer(function(){app.relatedRect=app.related_.getBoundingClientRect(),app.bodyRect=document.body.getBoundingClientRect(),app.stickyBarPosition=Math.abs(app.relatedRect.top)+Math.abs(app.bodyRect.top)+Math.abs(app.relatedRect.height)}),fastdom.defer(function(){for(d=document.querySelectorAll(".reveal-text"),e=d.length,i=0;e>i;++i)addEvent(d[i],"click",revealText)}),g.hits.hits.length<20?(app.loading.stillMore=!1,swapClass(app.moreContent_,"hidden",regHidden)):(app.loading.stillMore=!0,swapClass(app.moreContent_,"",regHidden))}h&&(app.placeMeta=h._scroll_id,document.cookie="placeMeta="+app.placeMeta+"; expires="+c),fastdom.defer(function(){app.resultsRect=app.results_.getBoundingClientRect(),app.loading.currentHeight=Math.abs(app.resultsRect.height),app.loading.now=!1}),app.searchBoxToggle("close"),swapClass(app.loader_,"",regLoad)}function submitQuery(a,b,c,d){var e=new XMLHttpRequest,f=app.term,g=document.location.protocol+"//that.pub/find/"+a+"/"+b,h={t:querySetup(f),g:c,s:d},i=JSON.stringify(h);e.onreadystatechange=function(){4===e.readyState&&200===e.status&&handleResponse(e,b)},e.open("POST",g,!0),e.setRequestHeader("Content-type","application/json"),e.send(i)}!function(){function a(b,d){function e(a,b){return function(){return a.apply(b,arguments)}}var f;if(d=d||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=d.touchBoundary||10,this.layer=b,this.tapDelay=d.tapDelay||200,this.tapTimeout=d.tapTimeout||700,!a.notNeeded(b)){for(var g=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],h=this,i=0,j=g.length;j>i;i++)h[g[i]]=e(h[g[i]],h);c&&(b.addEventListener("mouseover",this.onMouse,!0),b.addEventListener("mousedown",this.onMouse,!0),b.addEventListener("mouseup",this.onMouse,!0)),b.addEventListener("click",this.onClick,!0),b.addEventListener("touchstart",this.onTouchStart,!1),b.addEventListener("touchmove",this.onTouchMove,!1),b.addEventListener("touchend",this.onTouchEnd,!1),b.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(b.removeEventListener=function(a,c,d){var e=Node.prototype.removeEventListener;"click"===a?e.call(b,a,c.hijacked||c,d):e.call(b,a,c,d)},b.addEventListener=function(a,c,d){var e=Node.prototype.addEventListener;"click"===a?e.call(b,a,c.hijacked||(c.hijacked=function(a){a.propagationStopped||c(a)}),d):e.call(b,a,c,d)}),"function"==typeof b.onclick&&(f=b.onclick,b.addEventListener("click",function(a){f(a)},!1),b.onclick=null)}}var b=navigator.userAgent.indexOf("Windows Phone")>=0,c=navigator.userAgent.indexOf("Android")>0&&!b,d=/iP(ad|hone|od)/.test(navigator.userAgent)&&!b,e=d&&/OS 4_\d(_\d)?/.test(navigator.userAgent),f=d&&/OS [6-7]_\d/.test(navigator.userAgent),g=navigator.userAgent.indexOf("BB10")>0;a.prototype.needsClick=function(a){switch(a.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(a.disabled)return!0;break;case"input":if(d&&"file"===a.type||a.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return/\bneedsclick\b/.test(a.className)},a.prototype.needsFocus=function(a){switch(a.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!c;case"input":switch(a.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!a.disabled&&!a.readOnly;default:return/\bneedsfocus\b/.test(a.className)}},a.prototype.sendClick=function(a,b){var c,d;document.activeElement&&document.activeElement!==a&&document.activeElement.blur(),d=b.changedTouches[0],c=document.createEvent("MouseEvents"),c.initMouseEvent(this.determineEventType(a),!0,!0,window,1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,!1,!1,0,null),c.forwardedTouchEvent=!0,a.dispatchEvent(c)},a.prototype.determineEventType=function(a){return c&&"select"===a.tagName.toLowerCase()?"mousedown":"click"},a.prototype.focus=function(a){var b;d&&a.setSelectionRange&&0!==a.type.indexOf("date")&&"time"!==a.type&&"month"!==a.type?(b=a.value.length,a.setSelectionRange(b,b)):a.focus()},a.prototype.updateScrollParent=function(a){var b,c;if(b=a.fastClickScrollParent,!b||!b.contains(a)){c=a;do{if(c.scrollHeight>c.offsetHeight){b=c,a.fastClickScrollParent=c;break}c=c.parentElement}while(c)}b&&(b.fastClickLastScrollTop=b.scrollTop)},a.prototype.getTargetElementFromEventTarget=function(a){return a.nodeType===Node.TEXT_NODE?a.parentNode:a},a.prototype.onTouchStart=function(a){var b,c,f;if(a.targetTouches.length>1)return!0;if(b=this.getTargetElementFromEventTarget(a.target),c=a.targetTouches[0],d){if(f=window.getSelection(),f.rangeCount&&!f.isCollapsed)return!0;if(!e){if(c.identifier&&c.identifier===this.lastTouchIdentifier)return a.preventDefault(),!1;this.lastTouchIdentifier=c.identifier,this.updateScrollParent(b)}}return this.trackingClick=!0,this.trackingClickStart=a.timeStamp,this.targetElement=b,this.touchStartX=c.pageX,this.touchStartY=c.pageY,a.timeStamp-this.lastClickTime<this.tapDelay&&a.preventDefault(),!0},a.prototype.touchHasMoved=function(a){var b=a.changedTouches[0],c=this.touchBoundary;return Math.abs(b.pageX-this.touchStartX)>c||Math.abs(b.pageY-this.touchStartY)>c?!0:!1},a.prototype.onTouchMove=function(a){return this.trackingClick?((this.targetElement!==this.getTargetElementFromEventTarget(a.target)||this.touchHasMoved(a))&&(this.trackingClick=!1,this.targetElement=null),!0):!0},a.prototype.findControl=function(a){return void 0!==a.control?a.control:a.htmlFor?document.getElementById(a.htmlFor):a.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},a.prototype.onTouchEnd=function(a){var b,g,h,i,j,k=this.targetElement;if(!this.trackingClick)return!0;if(a.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;if(a.timeStamp-this.trackingClickStart>this.tapTimeout)return!0;if(this.cancelNextClick=!1,this.lastClickTime=a.timeStamp,g=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,f&&(j=a.changedTouches[0],k=document.elementFromPoint(j.pageX-window.pageXOffset,j.pageY-window.pageYOffset)||k,k.fastClickScrollParent=this.targetElement.fastClickScrollParent),h=k.tagName.toLowerCase(),"label"===h){if(b=this.findControl(k)){if(this.focus(k),c)return!1;k=b}}else if(this.needsFocus(k))return a.timeStamp-g>100||d&&window.top!==window&&"input"===h?(this.targetElement=null,!1):(this.focus(k),this.sendClick(k,a),d&&"select"===h||(this.targetElement=null,a.preventDefault()),!1);return d&&!e&&(i=k.fastClickScrollParent,i&&i.fastClickLastScrollTop!==i.scrollTop)?!0:(this.needsClick(k)||(a.preventDefault(),this.sendClick(k,a)),!1)},a.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},a.prototype.onMouse=function(a){return this.targetElement?a.forwardedTouchEvent?!0:a.cancelable&&(!this.needsClick(this.targetElement)||this.cancelNextClick)?(a.stopImmediatePropagation?a.stopImmediatePropagation():a.propagationStopped=!0,a.stopPropagation(),a.preventDefault(),!1):!0:!0},a.prototype.onClick=function(a){var b;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):"submit"===a.target.type&&0===a.detail?!0:(b=this.onMouse(a),b||(this.targetElement=null),b)},a.prototype.destroy=function(){var a=this.layer;c&&(a.removeEventListener("mouseover",this.onMouse,!0),a.removeEventListener("mousedown",this.onMouse,!0),a.removeEventListener("mouseup",this.onMouse,!0)),a.removeEventListener("click",this.onClick,!0),a.removeEventListener("touchstart",this.onTouchStart,!1),a.removeEventListener("touchmove",this.onTouchMove,!1),a.removeEventListener("touchend",this.onTouchEnd,!1),a.removeEventListener("touchcancel",this.onTouchCancel,!1)},a.notNeeded=function(a){var b,d,e,f;if(void 0===window.ontouchstart)return!0;if(d=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1]){if(!c)return!0;if(b=document.querySelector("meta[name=viewport]")){if(-1!==b.content.indexOf("user-scalable=no"))return!0;if(d>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}if(g&&(e=navigator.userAgent.match(/Version\/([0-9]*)\.([0-9]*)/),e[1]>=10&&e[2]>=3&&(b=document.querySelector("meta[name=viewport]")))){if(-1!==b.content.indexOf("user-scalable=no"))return!0;if(document.documentElement.scrollWidth<=window.outerWidth)return!0}return"none"===a.style.msTouchAction||"manipulation"===a.style.touchAction?!0:(f=+(/Firefox\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1],f>=27&&(b=document.querySelector("meta[name=viewport]"),b&&(-1!==b.content.indexOf("user-scalable=no")||document.documentElement.scrollWidth<=window.outerWidth))?!0:"none"===a.style.touchAction||"manipulation"===a.style.touchAction?!0:!1)},a.attach=function(b,c){return new a(b,c)},"function"==typeof define&&"object"==typeof define.amd&&define.amd?define(function(){return a}):"undefined"!=typeof module&&module.exports?(module.exports=a.attach,module.exports.FastClick=a):window.FastClick=a}(),function(){function a(a){return"string"==typeof a?a:null==a?"":a+""}function b(a){return O[a]}function c(a){return"\\"+Q[a]}function d(a){return a&&"object"==typeof a||!1}function e(a){if(d(a)&&!ia(a)){if(a instanceof LodashWrapper)return a;if($.call(a,"__wrapped__"))return new LodashWrapper(a.__wrapped__,a.__chain__,arrayCopy(a.__actions__))}return new LodashWrapper(a)}function f(a,b,c,d){return void 0!==a&&$.call(d,c)?a:b}function g(a,b,c){var d=ja(b);if(!c){d||(d=a,a={}),c=-1;for(var e=d.length;++c<e;){var f=d[c];a[f]=b[f]}return a}for(e=-1,f=d.length;++e<f;){var g=d[e],h=a[g],i=c(h,b[g],g,a,b);(i===i?i===h:h!==h)&&(void 0!==h||g in a)||(a[g]=i)}return a}function h(a,b){for(var c=-1,d=b.length,e=Array(d);++c<d;)e[c]=a[b[c]];return e}function i(a,b){return a=+a,b=null==b?fa:b,a>-1&&0==a%1&&b>a}function j(a,b,c){if(!o(c))return!1;var d=typeof b;return"number"==d?(d=c.length,d=k(d)&&i(b,d)):d="string"==d&&b in c,d&&c[b]===a}function k(a){return"number"==typeof a&&a>-1&&0==a%1&&fa>=a}function l(a){for(var b=r(a),c=b.length,d=c&&a.length,f=e.support,f=d&&k(d)&&(ia(a)||f.nonEnumStrings&&q(a)||f.nonEnumArgs&&m(a)),g=-1,h=[];++g<c;){var j=b[g];(f&&i(j,d)||$.call(a,j))&&h.push(j)}return h}function m(a){return k(d(a)?a.length:u)&&_.call(a)==v||!1}function n(a){return d(a)&&"string"==typeof a.message&&_.call(a)==w||!1}function o(a){var b=typeof a;return"function"==b||a&&"object"==b||!1}function p(a){return null==a?!1:_.call(a)==x?aa.test(Z.call(a)):d(a)&&(U(a)?aa:H).test(a)||!1}function q(a){return"string"==typeof a||d(a)&&_.call(a)==z||!1}function r(a){if(null==a)return[];o(a)||(a=Object(a));for(var b=a.length,c=e.support,b=b&&k(b)&&(ia(a)||c.nonEnumStrings&&q(a)||c.nonEnumArgs&&m(a))&&b||0,d=a.constructor,f=-1,d="function"==typeof d&&d.prototype||X,g=d===a,h=Array(b),j=b>0,l=c.enumErrorProps&&(a===W||a instanceof Error),n=c.enumPrototypes&&"function"==typeof a;++f<b;)h[f]=f+"";for(var p in a)n&&"prototype"==p||l&&("message"==p||"name"==p)||j&&i(p,b)||"constructor"==p&&(g||!$.call(a,p))||h.push(p);if(c.nonEnumShadows&&a!==X)for(b=a===Y?z:a===W?w:_.call(a),c=ga[b]||ga[y],b==y&&(d=X),b=N.length;b--;)p=N[b],f=c[p],g&&f||(f?!$.call(a,p):a[p]===d[p])||h.push(p);return h}function s(b){return(b=a(b))&&K.test(b)?b.replace(J,"\\$&"):b}function t(a){try{return a()}catch(b){return n(b)?b:Error(b)}}var u,v="[object Arguments]",w="[object Error]",x="[object Function]",y="[object Object]",z="[object String]",A=/\b__p\+='';/g,B=/\b(__p\+=)''\+/g,C=/(__e\(.*?\)|\b__t\))\+'';/g,D=/[&<>"'`]/g,E=RegExp(D.source),F=/<%=([\s\S]+?)%>/g,G=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,H=/^\[object .+?Constructor\]$/,I=/($^)/,J=/[.*+?^${}()|[\]\/\\]/g,K=RegExp(J.source),L=/\bthis\b/,M=/['\n\r\u2028\u2029\\]/g,N="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),O={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},P={function:!0,object:!0},Q={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},R=P[typeof window]&&window!==(this&&this.window)?window:this,S=P[typeof exports]&&exports&&!exports.nodeType&&exports,P=P[typeof module]&&module&&!module.nodeType&&module,T=S&&P&&"object"==typeof global&&global;!T||T.global!==T&&T.window!==T&&T.self!==T||(R=T);var T=P&&P.exports===S&&S,U=function(){try{Object({toString:0}+"")}catch(a){return function(){return!1}}return function(a){return"function"!=typeof a.toString&&"string"==typeof(a+"")}}(),V=Array.prototype,W=Error.prototype,X=Object.prototype,Y=String.prototype,Z=Function.prototype.toString,$=X.hasOwnProperty,_=X.toString,aa=RegExp("^"+s(_).replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ba=X.propertyIsEnumerable,ca=V.splice,da=p(da=Array.isArray)&&da,ea=p(ea=Object.keys)&&ea,fa=Math.pow(2,53)-1,ga={};ga["[object Array]"]=ga["[object Date]"]=ga["[object Number]"]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},ga["[object Boolean]"]=ga[z]={constructor:!0,toString:!0,valueOf:!0},ga[w]=ga[x]=ga["[object RegExp]"]={constructor:!0,toString:!0},ga[y]={constructor:!0},function(a,b){for(var c=-1,d=a.length;++c<d&&!1!==b(a[c],c,a););return a}(N,function(a){for(var b in ga)if($.call(ga,b)){var c=ga[b];c[a]=$.call(c,a)}});var ha=e.support={};!function(){function a(){this.x=1}var b={0:1,length:1},c=[];a.prototype={valueOf:1,y:1};for(var d in new a)c.push(d);ha.argsTag=_.call(arguments)==v,ha.enumErrorProps=ba.call(W,"message")||ba.call(W,"name"),ha.enumPrototypes=ba.call(a,"prototype"),ha.funcDecomp=!p(R.WinRTError)&&L.test(function(){return this}),ha.funcNames="string"==typeof Function.name,ha.nonEnumStrings=!ba.call("x",0),ha.nonEnumShadows=!/valueOf/.test(c),ha.spliceObjects=(ca.call(b,0,1),!b[0]),ha.unindexedChars="xx"!="x"[0]+Object("x")[0];try{ha.nonEnumArgs=!ba.call(arguments,1)}catch(g){ha.nonEnumArgs=!0}}(0,0),e.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:F,variable:"",imports:{_:e}},ha.argsTag||(m=function(a){return k(d(a)?a.length:u)&&$.call(a,"callee")&&!ba.call(a,"callee")||!1});var ia=da||function(a){return d(a)&&k(a.length)&&"[object Array]"==_.call(a)||!1},ja=ea?function(a){if(a)var b=a.constructor,c=a.length;return"function"==typeof b&&b.prototype===a||("function"==typeof a?e.support.enumPrototypes:c&&k(c))?l(a):o(a)?ea(a):[]}:l;e.keys=ja,e.keysIn=r,e.attempt=t,e.escape=function(c){return(c=a(c))&&E.test(c)?c.replace(D,b):c},e.escapeRegExp=s,e.isArguments=m,e.isArray=ia,e.isError=n,e.isNative=p,e.isObject=o,e.isString=q,e.template=function(b,d,i){var k=e.templateSettings;i&&j(b,d,i)&&(d=i=null),b=a(b),d=g(g({},i||d),k,f),i=g(g({},d.imports),k.imports,f);var l,m,o=ja(i),p=h(i,o),q=0;i=d.interpolate||I;var r="__p+='",s="sourceURL"in d?"//# sourceURL="+d.sourceURL+"\n":"";if(b.replace(RegExp((d.escape||I).source+"|"+i.source+"|"+(i===F?G:I).source+"|"+(d.evaluate||I).source+"|$","g"),function(a,d,e,f,g,h){return e||(e=f),r+=b.slice(q,h).replace(M,c),d&&(l=!0,r+="'+__e("+d+")+'"),g&&(m=!0,r+="';"+g+";\n__p+='"),e&&(r+="'+((__t=("+e+"))==null?'':__t)+'"),q=h+a.length,a}),r+="';",(d=d.variable)||(r="with(obj){"+r+"}"),r=(m?r.replace(A,""):r).replace(B,"$1").replace(C,"$1;"),r="function("+(d||"obj")+"){"+(d?"":"obj||(obj={});")+"var __t,__p=''"+(l?",__e=_.escape":"")+(m?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+r+"return __p}",d=t(function(){return Function(o,s+"return "+r).apply(u,p)}),d.source=r,n(d))throw d;return d},e.VERSION="3.1.0","function"==typeof define&&"object"==typeof define.amd&&define.amd?(R._=e,define(function(){return e})):S&&P?T?(P.exports=e)._=e:S._=e:R._=e}.call(this),function(a){function b(){this.frames=[],this.lastId=0,this.raf=c,this.batch={hash:{},read:[],write:[],mode:null}}var c=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1e3/60)};b.prototype.read=function(a,b){var c=this.add("read",a,b),d=c.id;this.batch.read.push(c.id);var e="reading"===this.batch.mode||this.batch.scheduled;return e?d:(this.scheduleBatch(),d)},b.prototype.write=function(a,b){var c=this.add("write",a,b),d=this.batch.mode,e=c.id;this.batch.write.push(c.id);var f="writing"===d||"reading"===d||this.batch.scheduled;return f?e:(this.scheduleBatch(),e)},b.prototype.defer=function(a,b,c){"function"==typeof a&&(c=b,b=a,a=1);var d=this,e=a-1;return this.schedule(e,function(){d.run({fn:b,ctx:c})})},b.prototype.clear=function(a){if("function"==typeof a)return this.clearFrame(a);a=+a;var b=this.batch.hash[a];if(b){var c=this.batch[b.type],d=c.indexOf(a);delete this.batch.hash[a],~d&&c.splice(d,1)}},b.prototype.clearFrame=function(a){var b=this.frames.indexOf(a);~b&&this.frames.splice(b,1)},b.prototype.scheduleBatch=function(){var a=this;this.schedule(0,function(){a.batch.scheduled=!1,a.runBatch()}),this.batch.scheduled=!0},b.prototype.uniqueId=function(){return++this.lastId},b.prototype.flush=function(a){for(var b;b=a.shift();)this.run(this.batch.hash[b])},b.prototype.runBatch=function(){try{this.batch.mode="reading",this.flush(this.batch.read),this.batch.mode="writing",this.flush(this.batch.write),this.batch.mode=null}catch(e){throw this.runBatch(),e}},b.prototype.add=function(a,b,c){var d=this.uniqueId();return this.batch.hash[d]={id:d,fn:b,ctx:c,type:a}},b.prototype.run=function(a){var b=a.ctx||this,c=a.fn;if(delete this.batch.hash[a.id],!this.onError)return c.call(b);try{c.call(b)}catch(e){this.onError(e)}},b.prototype.loop=function(){var a=this,b=this.raf;this.looping||(b(function c(){var d=a.frames.shift();a.frames.length?b(c):a.looping=!1,d&&d()}),this.looping=!0)},b.prototype.schedule=function(a,b){return this.frames[a]?this.schedule(a+1,b):(this.loop(),this.frames[a]=b)},a=a||new b,"undefined"!=typeof module&&module.exports?module.exports=a:"function"==typeof define&&define.amd?define(function(){return a}):window.fastdom=a}(window.fastdom);var regPubMatch=/productNo(?:\.exact|\.raw)?(?=\:|$)/,regCheckInput=/[A-Za-z0-9\s\-\_\.\,\&]/g,regFixInput=/[^A-Za-z0-9\s\-\_\.\,\&]/g,regEmerge=/ ?emerge/g,regHidden=/ ?hidden/g,regLoad=/ ?loading/g,regSelected=/ ?selected/g,regOpened=/ ?opened/g,regFail=/ ?failed/g,regValidate=/ ?invalidated/g,regQueryPubName=/(?:\b[\-_a-zA-Z]{1,3})?[ \t\-]*(?:(?:[\.\-]|[0-9]+)+)+(?:_?(?:sup|SUP)[A-Za-z]*)?/g,regEOLDashCheck=/[\-\cI\v\0\f]$/m,regPreTitle=/(?:\W?)\w\S*/g;String.prototype.toTitle=function(){return this.replace(regPreTitle,function(a){return a.charAt(0).toUpperCase()+a.substr(1).toLowerCase()})},String.prototype.toPubName=function(){var a,b=0,c=[];return a=this.replace(regQueryPubName,function(a){return c&&c.length>0&&regEOLDashCheck.test(c[b-1])?c[b-1]+=a.toUpperCase().replace(/\s/g,""):c.push(a.toUpperCase().replace(/\s/g,"")),b+=1,""}),{remove:a,extract:c}},CSSStyleSheet.prototype.addCSSRule=function(a,b,c){"insertRule"in this?this.insertRule(a+"{"+b+"}",c):"addRule"in this&&this.addRule(a,b,c)},window.downloader=function(a){var b=document.createElement("a"),c=a.href||a.getAttribute("href")||"";if(""===c)return!1;b.download=a.download||a.getAttribute("download"),b.href=c,b.target="_blank";try{b.click()}catch(e){try{window.open(c)}catch(ee){window.location.href=c}}return!1};var months={"01":"Jan","02":"Feb","03":"Mar","04":"Apr","05":"May","06":"Jun","07":"Jul","08":"Aug","09":"Sep",10:"Oct",11:"Nov",12:"Dec"},app=function(a,b){var c,d,e,f,g,h=b.getElementById("wrap"),i=b.getElementById("search-wrap"),j=b.getElementById("search-restore"),k=j.getElementsByTagName("svg")[0],l=j.getElementsByTagName("svg")[1],m=b.getElementById("page"),n=b.getElementById("page-header"),o=b.getElementById("related"),p=b.getElementById("results"),q=b.getElementById("count"),r=b.getElementById("term"),s=b.getElementById("total"),t=b.getElementById("message"),u=b.getElementById("query"),v=b.getElementById("send"),w=b.getElementById("more-content"),x=b.getElementById("infini-label"),y=b.getElementById("infini-scroll"),z=b.getElementById("loader"),A=b.cookie.placeContent||"",B=b.cookie.placeMeta||"";return{wrap_:h,searchWrap_:i,searchRestore_:j,searchIcon_:k,xIcon_:l,page_:m,pageHeader_:n,related_:o,results_:p,count_:q,term_:r,total_:s,message_:t,query_:u,send_:v,moreContent_:w,placeContent:A,placeMeta:B,infiniLabel_:x,infiniScroll_:y,loader_:z,resultTemplate:null,relatedTemplate:null,infiniScroll:!0,loading:{now:!1,stillMore:!1,currentHeight:0},bodyRect:c,relatedRect:d,resultsRect:e,relatedOffsetTop:f,stickyBarPosition:g,traveling:!1,pos:0,term:"",scoresContent:[],scoresRelatives:[],selectedResults:[],selectedTotal:0,colors:{},isSearchBoxOpen:null,isFailure:null,isDone:!1,organizeData:function(a,c,d){var e,f,g,h,i,j,k,l,m,n={},o=/chapter|section/;return!a._source&&a.key&&a.score?(e=c.indexOf(a.score),f=e>-1?" match-"+e:"",app.colors[a.key]=e,n={key:a.key,url:b.location.protocol+"//get.that.pub/"+a.key.toLowerCase()+".pdf",score:a.score,gravitas:d<a.score||a.score>=1?" pretty"+f:" boring"+f}):a._source.text&&(g=a._source.number,j=a.highlight["text.english2"],i=a._source.text,h=a._source.productNo,l=Object.keys(a.highlight),m="form"!==a._type?".pdf":".xfdl",regPubMatch.test(l.join(":"))&&(h=a.highlight["productNo.exact"]||a.highlight["productNo.raw"]||a.highlight.productNo,h=h.shift()),k=a._source.releaseDate?a._source.releaseDate.substring(6,8)+" "+months[a._source.releaseDate.substring(4,6)]+" "+a._source.releaseDate.substring(0,4):a._source.publishedDate.substring(0,2)+" "+months[a._source.publishedDate.substring(2,4)]+" "+a._source.publishedDate.substring(4,8),o.test(a._type)&&7==a._type.length&&(g=a._type.toTitle()+" "+a._source.number),e=app.colors[a._source.productNo||a._source.pubName],f=e&&"number"==typeof e&&(e>=0||5>e)?" match-"+e:"",n={score:a._score,gravitas:d<a.score||a.score>=1?" pretty"+f:" boring"+f,date:k,url:b.location.protocol+"//get.that.pub/"+a._source.productNo.toLowerCase()+m,fullPub:h,title:a.highlight.title||a._source.title||null,rawTitle:a._source.title,sub:i?g:"",details:{chapter:a._source.chapter&&a._source.chapter.number||null,chapterTitle:a.highlight["chapter.title"]||a._source.chapter&&a._source.chapter.title||null,section:a._source.section&&a._source.section.number||null,sectionTitle:a.highlight["section.title"]||a._source.section&&a._source.section.title||null},rawText:i,concatText:a.highlight.text&&a.highlight.text[0]||null,parts:Array.isArray(j)?j:null,fileFormat:m,type:i?" content":" doc"}),n||null},renderResults:function(a,b){var c,d,e,f="",g={},h=b.length,i=0;for("results"===a?(d=this.resultTemplate,e=this.scoresContent,c=upperOutlier(e)):(d=this.relatedTemplate,e=this.scoresRelatives,c=upperOutlier(e));h>i;++i)g=this.organizeData(b[i],e,c),f+=d(g);return f},searchBoxToggle:function(a){var b=this;"close"===a?(this.infiniScroll=this.infiniScroll_?this.infiniScroll_.checked||!!this.infiniScroll_.checked:!0,this.term=this.query_.value.trim(),swapClass(this.searchWrap_,"",regEmerge),swapClass(this.searchWrap_,"",regFail),fastdom.write(function(){b.searchIcon_.style.display="",b.xIcon_.style.display="none",b.message_.innerHTML=""}),this.isSearchBoxOpen=!1):"open"===a&&(fastdom.write(function(){b.query_.value=b.term,b.searchIcon_.style.display="none",b.xIcon_.style.display=""}),swapClass(this.searchWrap_,"emerge",regEmerge),this.isFailure===!0&&(this.isFailure=!1,swapClass(this.searchWrap_,"failed",regFail)),this.isSearchBoxOpen=!0,this.infiniScroll=!1)}}}(this,this.document,_);!function(a,b,c,d,e){addEvent(d.send_,"click",searchStart),addEvent(d.query_,"focus",function(){return d.queryInvalidated!==!0?!1:e}),addEvent(d.query_,"keypress",function(a){return d.queryInvalidated===!0&&(d.queryInvalidated=!1,swapClass(d.query_,"",regValidate),d.message_.innerHTML=""),13===a.which?(searchStart(a),!1):e}),addEvent(b,"keyup",function(a){27===a.which&&(a.preventDefault(),d.isSearchBoxOpen===!0&&d.isFailure!==!0&&d.searchBoxToggle("close"))}),addEvent(d.moreContent_,"click",more),addEvent(d.searchRestore_,"click",function(a){if(a.preventDefault(),d.isSearchBoxOpen===!0){if(d.isDone!==!0||d.isFailure===!0)return!1;d.searchBoxToggle("close")}else d.searchBoxToggle("open"),d.query_.value=d.term,d.query_.focus();return!1}),addEvent(d.infiniScroll_,"change",infini),addEvent(a,"scroll",scrollWheeler),addEvent(a,"load",function(){d.isSearchBoxOpen=!0,d.isDone=!1,d.query_.focus();var a=b.createDocumentFragment(),c=b.createElement("script");c.src="/js/templates.js",a.appendChild(c),b.body.appendChild(a),fastdom.write(function(){var a=b.createDocumentFragment(),c=b.createElement("link");c.rel="stylesheet",c.href="/css/after.css";var d=b.getElementsByTagName("head")[0];a.appendChild(c),d.appendChild(a)})}),addEvent(b,"DOMContentLoaded",function(){FastClick.attach(b.body)})}(this,this.document,_,app);